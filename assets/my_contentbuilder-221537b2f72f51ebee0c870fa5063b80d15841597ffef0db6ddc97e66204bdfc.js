/*!
 * jQuery UI Core 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */
function saveSelection(){if(window.getSelection){if(sel=window.getSelection(),sel.getRangeAt&&sel.rangeCount){for(var t=[],e=0,i=sel.rangeCount;i>e;++e)t.push(sel.getRangeAt(e));return t}}else if(document.selection&&document.selection.createRange)return document.selection.createRange();return null}function restoreSelection(t){if(t)if(window.getSelection){sel=window.getSelection(),sel.removeAllRanges();for(var e=0,i=t.length;i>e;++e)sel.addRange(t[e])}else document.selection&&t.select&&t.select()}function saveAbsoluteSelection(t){if(window.getSelection&&document.createRange){var e,i,n,o,s;return e=t.ownerDocument,s=e.defaultView,n=s.getSelection().getRangeAt(0),i=n.cloneRange(),i.selectNodeContents(t),i.setEnd(n.startContainer,n.startOffset),o=i.toString().length,{start:o,end:o+n.toString().length}}if(document.selection){var e,a,r,o,s;return e=t.ownerDocument,s=e.defaultView||e.parentWindow,r=e.selection.createRange(),a=e.body.createTextRange(),a.moveToElementText(t),a.setEndPoint("EndToStart",r),o=a.text.length,{start:o,end:o+r.text.length}}}function restoreAbsoluteSelection(t,e){if(window.getSelection&&document.createRange){var i,n,o,s,a,r,l,d,c,h,p;for(n=t.ownerDocument,p=n.defaultView,i=0,d=n.createRange(),d.setStart(t,0),d.collapse(!0),l=[t],r=void 0,o=!1,h=!1;!h&&(r=l.pop());)if(3===r.nodeType)a=i+r.length,!o&&e.start>=i&&e.start<=a&&(d.setStart(r,e.start-i),o=!0),o&&e.end>=i&&e.end<=a&&(d.setEnd(r,e.end-i),h=!0),i=a;else for(s=r.childNodes.length;s--;)l.push(r.childNodes[s]);c=p.getSelection(),c.removeAllRanges(),c.addRange(d)}else if(document.selection){var n,m,p;n=t.ownerDocument,p=n.defaultView||n.parentWindow,m=n.body.createTextRange(),m.moveToElementText(t),m.collapse(!0),m.moveEnd("character",e.end),m.moveStart("character",e.start),m.select()}}function getSelectionStartNode(){var t,e;if(window.getSelection&&(e=getSelection(),t=e.anchorNode),!t&&document.selection){e=document.selection;var i=e.getRangeAt?e.getRangeAt(0):e.createRange();t=i.commonAncestorContainer?i.commonAncestorContainer:i.parentElement?i.parentElement():i.item(0)}return t?"#text"==t.nodeName?t.parentNode:t:void 0}function getSelected(){if(window.getSelection)return window.getSelection();if(document.getSelection)return document.getSelection();var t=document.selection&&document.selection.createRange();return t.text?t.text:!1}function selectNodeContents(t){var e,i;document.body.createTextRange?(e=document.body.createTextRange(),e.moveToElementText(t),e.select()):window.getSelection&&(i=window.getSelection(),e=document.createRange(),e.selectNodeContents(t),i.removeAllRanges(),i.addRange(e))}function selectEndOfNodeContents(t){var e,i;document.createRange?(e=document.createRange(),e.selectNodeContents(t),e.collapse(!1),i=window.getSelection(),i.removeAllRanges(),i.addRange(e)):document.selection&&(e=document.body.createTextRange(),e.moveToElementText(t),e.collapse(!1),e.select())}function pasteHtmlAtCaret(t,e){var i,n;if(window.getSelection){if(i=window.getSelection(),i.getRangeAt&&i.rangeCount){n=i.getRangeAt(0),n.deleteContents();var o=document.createElement("div");o.innerHTML=t;for(var s,a,r=document.createDocumentFragment();s=o.firstChild;)a=r.appendChild(s);var l=r.firstChild;n.insertNode(r),a&&(n=n.cloneRange(),n.setStartAfter(a),e?n.setStartBefore(l):n.collapse(!0),i.removeAllRanges(),i.addRange(n))}}else if((i=document.selection)&&"Control"!=i.type){var d=i.createRange();d.collapse(!0),i.createRange().pasteHTML(t),e&&(n=i.createRange(),n.setEndPoint("StartToStart",d),n.select())}}function applyIcon(t,e){if($activeIcon){var i="";$activeIcon.hasClass("size-12")&&(i="size-12"),$activeIcon.hasClass("size-14")&&(i="size-14"),$activeIcon.hasClass("size-16")&&(i="size-16"),$activeIcon.hasClass("size-18")&&(i="size-18"),$activeIcon.hasClass("size-21")&&(i="size-21"),$activeIcon.hasClass("size-24")&&(i="size-24"),$activeIcon.hasClass("size-32")&&(i="size-32"),$activeIcon.hasClass("size-48")&&(i="size-48"),$activeIcon.hasClass("size-64")&&(i="size-64"),$activeIcon.hasClass("size-80")&&(i="size-80"),$activeIcon.hasClass("size-96")&&(i="size-96"),$activeIcon.css("font-size",""),-1==t.indexOf("size-")&&""!=t?($activeIcon.attr("class",t),""!=i&&$activeIcon.addClass(i)):($activeIcon.removeClass("size-12"),$activeIcon.removeClass("size-14"),$activeIcon.removeClass("size-16"),$activeIcon.removeClass("size-18"),$activeIcon.removeClass("size-21"),$activeIcon.removeClass("size-24"),$activeIcon.removeClass("size-32"),$activeIcon.removeClass("size-48"),$activeIcon.removeClass("size-64"),$activeIcon.removeClass("size-80"),$activeIcon.removeClass("size-96"),$activeIcon.addClass(t)),e&&$activeIcon.text(e)}else restoreSelection($savedSel),pasteHtmlAtCaret('<i class="'+t+'" id="new-added-icon">'+(e||"")+"</i>",!0),selectNodeContents(jQuery("#new-added-icon").removeAttr("id")[0]),jQuery(cb_list).each(function(){jQuery(this).data("contenteditor").applyIconBehavior()});jQuery(cb_list).each(function(){jQuery(this).data("contenteditor").onChanged()}),jQuery("#md-icon-select").data("simplemodal").hide()}function applyLargerImage(t){$imgActive.parents("a").attr("href",t),jQuery(".my-file[type=file]").clearInputs()}function makeid(){for(var t="",e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;5>i;i++)t+=e.charAt(Math.floor(Math.random()*e.length));return t}function sleep(t){for(var e=(new Date).getTime(),i=0;1e7>i&&!((new Date).getTime()-e>t);i++);}function hideAllSimpleModals(){jQuery('[id^="md-"]').each(function(){$(this).data("simplemodal")&&$(this).data("simplemodal").hide()})}function detectIE(){var t=window.navigator.userAgent,e=t.indexOf("MSIE "),i=t.indexOf("Trident/"),n=t.indexOf("Edge/");if(e>0)return parseInt(t.substring(e+5,t.indexOf(".",e)),10);if(n>0)return parseInt(t.substring(n+5,t.indexOf(".",n)),10);if(i>0){var o=t.indexOf("rv:");return parseInt(t.substring(o+3,t.indexOf(".",o)),10)}return!1}function detectEdge(){var t=window.navigator.userAgent,e=t.indexOf("Edge/");return e>0?parseInt(t.substring(e+5,t.indexOf(".",e)),10):!1}function isEmail(t){var e=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return e.test(t)}function prependHttp(t){return/^https?:\/\//i.test(t)||(t="http://"+t),t}function toHref(t){return t=isEmail(t)&&!t.startsWith("mailto:")?"mailto:"+t:prependHttp(t)}!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){function e(e,n){var o,s,a,r=e.nodeName.toLowerCase();return"area"===r?(o=e.parentNode,s=o.name,e.href&&s&&"map"===o.nodeName.toLowerCase()?(a=t("img[usemap='#"+s+"']")[0],!!a&&i(a)):!1):(/^(input|select|textarea|button|object)$/.test(r)?!e.disabled:"a"===r?e.href||n:n)&&i(e)}function i(e){return t.expr.filters.visible(e)&&!t(e).parents().addBack().filter(function(){return"hidden"===t.css(this,"visibility")}).length}t.ui=t.ui||{},t.extend(t.ui,{version:"1.11.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),t.fn.extend({scrollParent:function(e){var i=this.css("position"),n="absolute"===i,o=e?/(auto|scroll|hidden)/:/(auto|scroll)/,s=this.parents().filter(function(){var e=t(this);return n&&"static"===e.css("position")?!1:o.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))}).eq(0);return"fixed"!==i&&s.length?s:t(this[0].ownerDocument||document)},uniqueId:function(){var t=0;return function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++t)})}}(),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&t(this).removeAttr("id")})}}),t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(i){return!!t.data(i,e)}}):function(e,i,n){return!!t.data(e,n[3])},focusable:function(i){return e(i,!isNaN(t.attr(i,"tabindex")))},tabbable:function(i){var n=t.attr(i,"tabindex"),o=isNaN(n);return(o||n>=0)&&e(i,!o)}}),t("<a>").outerWidth(1).jquery||t.each(["Width","Height"],function(e,i){function n(e,i,n,s){return t.each(o,function(){i-=parseFloat(t.css(e,"padding"+this))||0,n&&(i-=parseFloat(t.css(e,"border"+this+"Width"))||0),s&&(i-=parseFloat(t.css(e,"margin"+this))||0)}),i}var o="Width"===i?["Left","Right"]:["Top","Bottom"],s=i.toLowerCase(),a={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+i]=function(e){return void 0===e?a["inner"+i].call(this):this.each(function(){t(this).css(s,n(this,e)+"px")})},t.fn["outer"+i]=function(e,o){return"number"!=typeof e?a["outer"+i].call(this,e):this.each(function(){t(this).css(s,n(this,e,!0,o)+"px")})}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(t.fn.removeData=function(e){return function(i){return arguments.length?e.call(this,t.camelCase(i)):e.call(this)}}(t.fn.removeData)),t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),t.fn.extend({focus:function(e){return function(i,n){return"number"==typeof i?this.each(function(){var e=this;setTimeout(function(){t(e).focus(),n&&n.call(e)},i)}):e.apply(this,arguments)}}(t.fn.focus),disableSelection:function(){var t="onselectstart"in document.createElement("div")?"selectstart":"mousedown";return function(){return this.bind(t+".ui-disableSelection",function(t){t.preventDefault()})}}(),enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(e){if(void 0!==e)return this.css("zIndex",e);if(this.length)for(var i,n,o=t(this[0]);o.length&&o[0]!==document;){if(i=o.css("position"),("absolute"===i||"relative"===i||"fixed"===i)&&(n=parseInt(o.css("zIndex"),10),!isNaN(n)&&0!==n))return n;o=o.parent()}return 0}}),t.ui.plugin={add:function(e,i,n){var o,s=t.ui[e].prototype;for(o in n)s.plugins[o]=s.plugins[o]||[],s.plugins[o].push([i,n[o]])},call:function(t,e,i,n){var o,s=t.plugins[e];if(s&&(n||t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType))for(o=0;o<s.length;o++)t.options[s[o][0]]&&s[o][1].apply(t.element,i)}}}),/*!
 * jQuery UI Widget 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/jQuery.widget/
 */
function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t){var e=0,i=Array.prototype.slice;return t.cleanData=function(e){return function(i){var n,o,s;for(s=0;null!=(o=i[s]);s++)try{n=t._data(o,"events"),n&&n.remove&&t(o).triggerHandler("remove")}catch(a){}e(i)}}(t.cleanData),t.widget=function(e,i,n){var o,s,a,r,l={},d=e.split(".")[0];return e=e.split(".")[1],o=d+"-"+e,n||(n=i,i=t.Widget),t.expr[":"][o.toLowerCase()]=function(e){return!!t.data(e,o)},t[d]=t[d]||{},s=t[d][e],a=t[d][e]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new a(t,e)},t.extend(a,s,{version:n.version,_proto:t.extend({},n),_childConstructors:[]}),r=new i,r.options=t.widget.extend({},r.options),t.each(n,function(e,n){return t.isFunction(n)?void(l[e]=function(){var t=function(){return i.prototype[e].apply(this,arguments)},o=function(t){return i.prototype[e].apply(this,t)};return function(){var e,i=this._super,s=this._superApply;return this._super=t,this._superApply=o,e=n.apply(this,arguments),this._super=i,this._superApply=s,e}}()):void(l[e]=n)}),a.prototype=t.widget.extend(r,{widgetEventPrefix:s?r.widgetEventPrefix||e:e},l,{constructor:a,namespace:d,widgetName:e,widgetFullName:o}),s?(t.each(s._childConstructors,function(e,i){var n=i.prototype;t.widget(n.namespace+"."+n.widgetName,a,i._proto)}),delete s._childConstructors):i._childConstructors.push(a),t.widget.bridge(e,a),a},t.widget.extend=function(e){for(var n,o,s=i.call(arguments,1),a=0,r=s.length;r>a;a++)for(n in s[a])o=s[a][n],s[a].hasOwnProperty(n)&&void 0!==o&&(t.isPlainObject(o)?e[n]=t.isPlainObject(e[n])?t.widget.extend({},e[n],o):t.widget.extend({},o):e[n]=o);return e},t.widget.bridge=function(e,n){var o=n.prototype.widgetFullName||e;t.fn[e]=function(s){var a="string"==typeof s,r=i.call(arguments,1),l=this;return a?this.each(function(){var i,n=t.data(this,o);return"instance"===s?(l=n,!1):n?t.isFunction(n[s])&&"_"!==s.charAt(0)?(i=n[s].apply(n,r),i!==n&&void 0!==i?(l=i&&i.jquery?l.pushStack(i.get()):i,!1):void 0):t.error("no such method '"+s+"' for "+e+" widget instance"):t.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+s+"'")}):(r.length&&(s=t.widget.extend.apply(null,[s].concat(r))),this.each(function(){var e=t.data(this,o);e?(e.option(s||{}),e._init&&e._init()):t.data(this,o,new n(s,this))})),l}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(i,n){n=t(n||this.defaultElement||this)[0],this.element=t(n),this.uuid=e++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=t(),this.hoverable=t(),this.focusable=t(),n!==this&&(t.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===n&&this.destroy()}}),this.document=t(n.style?n.ownerDocument:n.document||n),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this.options=t.widget.extend({},this.options,this._getCreateOptions(),i),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(e,i){var n,o,s,a=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(a={},n=e.split("."),e=n.shift(),n.length){for(o=a[e]=t.widget.extend({},this.options[e]),s=0;s<n.length-1;s++)o[n[s]]=o[n[s]]||{},o=o[n[s]];if(e=n.pop(),1===arguments.length)return void 0===o[e]?null:o[e];o[e]=i}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];a[e]=i}return this._setOptions(a),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled",!!e),e&&(this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus"))),this},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_on:function(e,i,n){var o,s=this;"boolean"!=typeof e&&(n=i,i=e,e=!1),n?(i=o=t(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,o=this.widget()),t.each(n,function(n,a){function r(){return e||s.options.disabled!==!0&&!t(this).hasClass("ui-state-disabled")?("string"==typeof a?s[a]:a).apply(s,arguments):void 0}"string"!=typeof a&&(r.guid=a.guid=a.guid||r.guid||t.guid++);var l=n.match(/^([\w:-]*)\s*(.*)$/),d=l[1]+s.eventNamespace,c=l[2];c?o.delegate(c,d,r):i.bind(d,r)})},_off:function(e,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(i).undelegate(i),this.bindings=t(this.bindings.not(e).get()),this.focusable=t(this.focusable.not(e).get()),this.hoverable=t(this.hoverable.not(e).get())},_delay:function(t,e){function i(){return("string"==typeof t?n[t]:t).apply(n,arguments)}var n=this;return setTimeout(i,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,i,n){var o,s,a=this.options[e];if(n=n||{},i=t.Event(i),i.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],s=i.originalEvent)for(o in s)o in i||(i[o]=s[o]);return this.element.trigger(i,n),!(t.isFunction(a)&&a.apply(this.element[0],[i].concat(n))===!1||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,i){t.Widget.prototype["_"+e]=function(n,o,s){"string"==typeof o&&(o={effect:o});var a,r=o?o===!0||"number"==typeof o?i:o.effect||i:e;o=o||{},"number"==typeof o&&(o={duration:o}),a=!t.isEmptyObject(o),o.complete=s,o.delay&&n.delay(o.delay),a&&t.effects&&t.effects.effect[r]?n[e](o):r!==e&&n[r]?n[r](o.duration,o.easing,s):n.queue(function(i){t(this)[e](),s&&s.call(n[0]),i()})}}),t.widget}),/*!
 * jQuery UI Mouse 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/mouse/
 */
function(t){"function"==typeof define&&define.amd?define(["jquery","./widget"],t):t(jQuery)}(function(t){var e=!1;return t(document).mouseup(function(){e=!1}),t.widget("ui.mouse",{version:"1.11.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).bind("click."+this.widgetName,function(i){return!0===t.data(i.target,e.widgetName+".preventClickEvent")?(t.removeData(i.target,e.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(i){if(!e){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(i),this._mouseDownEvent=i;var n=this,o=1===i.which,s="string"==typeof this.options.cancel&&i.target.nodeName?t(i.target).closest(this.options.cancel).length:!1;return o&&!s&&this._mouseCapture(i)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){n.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(i)&&this._mouseDelayMet(i)&&(this._mouseStarted=this._mouseStart(i)!==!1,!this._mouseStarted)?(i.preventDefault(),!0):(!0===t.data(i.target,this.widgetName+".preventClickEvent")&&t.removeData(i.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return n._mouseMove(t)},this._mouseUpDelegate=function(t){return n._mouseUp(t)},this.document.bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),i.preventDefault(),e=!0,!0)):!0}},_mouseMove:function(e){if(this._mouseMoved){if(t.ui.ie&&(!document.documentMode||document.documentMode<9)&&!e.button)return this._mouseUp(e);if(!e.which)return this._mouseUp(e)}return(e.which||e.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==!1,this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(i){return this.document.unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,i.target===this._mouseDownEvent.target&&t.data(i.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(i)),e=!1,!1},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}),/*!
 * jQuery UI Draggable 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/draggable/
 */
function(t){"function"==typeof define&&define.amd?define(["jquery","./core","./mouse","./widget"],t):t(jQuery)}(function(t){return t.widget("ui.draggable",t.ui.mouse,{version:"1.11.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._setHandleClassName(),this._mouseInit()},_setOption:function(t,e){this._super(t,e),"handle"===t&&(this._removeHandleClassName(),this._setHandleClassName())},_destroy:function(){return(this.helper||this.element).is(".ui-draggable-dragging")?void(this.destroyOnClear=!0):(this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._removeHandleClassName(),void this._mouseDestroy())},_mouseCapture:function(e){var i=this.options;return this._blurActiveElement(e),this.helper||i.disabled||t(e.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(e),this.handle?(this._blockFrames(i.iframeFix===!0?"iframe":i.iframeFix),!0):!1)},_blockFrames:function(e){this.iframeBlocks=this.document.find(e).map(function(){var e=t(this);return t("<div>").css("position","absolute").appendTo(e.parent()).outerWidth(e.outerWidth()).outerHeight(e.outerHeight()).offset(e.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(e){var i=this.document[0];if(this.handleElement.is(e.target))try{i.activeElement&&"body"!==i.activeElement.nodeName.toLowerCase()&&t(i.activeElement).blur()}catch(n){}},_mouseStart:function(e){var i=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),t.ui.ddmanager&&(t.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=this.helper.parents().filter(function(){return"fixed"===t(this).css("position")}).length>0,this.positionAbs=this.element.offset(),this._refreshOffsets(e),this.originalPosition=this.position=this._generatePosition(e,!1),this.originalPageX=e.pageX,this.originalPageY=e.pageY,i.cursorAt&&this._adjustOffsetFromHelper(i.cursorAt),this._setContainment(),this._trigger("start",e)===!1?(this._clear(),!1):(this._cacheHelperProportions(),t.ui.ddmanager&&!i.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this._normalizeRightBottom(),this._mouseDrag(e,!0),t.ui.ddmanager&&t.ui.ddmanager.dragStart(this,e),!0)},_refreshOffsets:function(t){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),relative:this._getRelativeOffset()},this.offset.click={left:t.pageX-this.offset.left,top:t.pageY-this.offset.top}},_mouseDrag:function(e,i){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e,!0),this.positionAbs=this._convertPositionTo("absolute"),!i){var n=this._uiHash();if(this._trigger("drag",e,n)===!1)return this._mouseUp({}),!1;this.position=n.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=this.position.top+"px",t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var i=this,n=!1;return t.ui.ddmanager&&!this.options.dropBehaviour&&(n=t.ui.ddmanager.drop(this,e)),this.dropped&&(n=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!n||"valid"===this.options.revert&&n||this.options.revert===!0||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,n)?t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){i._trigger("stop",e)!==!1&&i._clear()}):this._trigger("stop",e)!==!1&&this._clear(),!1},_mouseUp:function(e){return this._unblockFrames(),t.ui.ddmanager&&t.ui.ddmanager.dragStop(this,e),this.handleElement.is(e.target)&&this.element.focus(),t.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){return this.options.handle?!!t(e.target).closest(this.element.find(this.options.handle)).length:!0},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this.handleElement.addClass("ui-draggable-handle")},_removeHandleClassName:function(){this.handleElement.removeClass("ui-draggable-handle")},_createHelper:function(e){var i=this.options,n=t.isFunction(i.helper),o=n?t(i.helper.apply(this.element[0],[e])):"clone"===i.helper?this.element.clone().removeAttr("id"):this.element;return o.parents("body").length||o.appendTo("parent"===i.appendTo?this.element[0].parentNode:i.appendTo),n&&o[0]===this.element[0]&&this._setPositionRelative(),o[0]===this.element[0]||/(fixed|absolute)/.test(o.css("position"))||o.css("position","absolute"),o},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_isRootNode:function(t){return/(html|body)/i.test(t.tagName)||t===this.document[0]},_getParentOffset:function(){var e=this.offsetParent.offset(),i=this.document[0];return"absolute"===this.cssPosition&&this.scrollParent[0]!==i&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),this._isRootNode(this.offsetParent[0])&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"!==this.cssPosition)return{top:0,left:0};var t=this.element.position(),e=this._isRootNode(this.scrollParent[0]);return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+(e?0:this.scrollParent.scrollTop()),left:t.left-(parseInt(this.helper.css("left"),10)||0)+(e?0:this.scrollParent.scrollLeft())}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,n,o=this.options,s=this.document[0];return this.relativeContainer=null,o.containment?"window"===o.containment?void(this.containment=[t(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,t(window).scrollLeft()+t(window).width()-this.helperProportions.width-this.margins.left,t(window).scrollTop()+(t(window).height()||s.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===o.containment?void(this.containment=[0,0,t(s).width()-this.helperProportions.width-this.margins.left,(t(s).height()||s.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):o.containment.constructor===Array?void(this.containment=o.containment):("parent"===o.containment&&(o.containment=this.helper[0].parentNode),i=t(o.containment),n=i[0],void(n&&(e=/(scroll|auto)/.test(i.css("overflow")),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(e?Math.max(n.scrollWidth,n.offsetWidth):n.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(n.scrollHeight,n.offsetHeight):n.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relativeContainer=i))):void(this.containment=null)},_convertPositionTo:function(t,e){e||(e=this.position);var i="absolute"===t?1:-1,n=this._isRootNode(this.scrollParent[0]);return{top:e.top+this.offset.relative.top*i+this.offset.parent.top*i-("fixed"===this.cssPosition?-this.offset.scroll.top:n?0:this.offset.scroll.top)*i,left:e.left+this.offset.relative.left*i+this.offset.parent.left*i-("fixed"===this.cssPosition?-this.offset.scroll.left:n?0:this.offset.scroll.left)*i}},_generatePosition:function(t,e){var i,n,o,s,a=this.options,r=this._isRootNode(this.scrollParent[0]),l=t.pageX,d=t.pageY;return r&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),e&&(this.containment&&(this.relativeContainer?(n=this.relativeContainer.offset(),i=[this.containment[0]+n.left,this.containment[1]+n.top,this.containment[2]+n.left,this.containment[3]+n.top]):i=this.containment,t.pageX-this.offset.click.left<i[0]&&(l=i[0]+this.offset.click.left),t.pageY-this.offset.click.top<i[1]&&(d=i[1]+this.offset.click.top),t.pageX-this.offset.click.left>i[2]&&(l=i[2]+this.offset.click.left),t.pageY-this.offset.click.top>i[3]&&(d=i[3]+this.offset.click.top)),a.grid&&(o=a.grid[1]?this.originalPageY+Math.round((d-this.originalPageY)/a.grid[1])*a.grid[1]:this.originalPageY,d=i?o-this.offset.click.top>=i[1]||o-this.offset.click.top>i[3]?o:o-this.offset.click.top>=i[1]?o-a.grid[1]:o+a.grid[1]:o,s=a.grid[0]?this.originalPageX+Math.round((l-this.originalPageX)/a.grid[0])*a.grid[0]:this.originalPageX,l=i?s-this.offset.click.left>=i[0]||s-this.offset.click.left>i[2]?s:s-this.offset.click.left>=i[0]?s-a.grid[0]:s+a.grid[0]:s),"y"===a.axis&&(l=this.originalPageX),"x"===a.axis&&(d=this.originalPageY)),{top:d-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:r?0:this.offset.scroll.top),left:l-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:r?0:this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_normalizeRightBottom:function(){"y"!==this.options.axis&&"auto"!==this.helper.css("right")&&(this.helper.width(this.helper.width()),this.helper.css("right","auto")),"x"!==this.options.axis&&"auto"!==this.helper.css("bottom")&&(this.helper.height(this.helper.height()),this.helper.css("bottom","auto"))},_trigger:function(e,i,n){return n=n||this._uiHash(),t.ui.plugin.call(this,e,[i,n,this],!0),/^(drag|start|stop)/.test(e)&&(this.positionAbs=this._convertPositionTo("absolute"),n.offset=this.positionAbs),t.Widget.prototype._trigger.call(this,e,i,n)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),t.ui.plugin.add("draggable","connectToSortable",{start:function(e,i,n){var o=t.extend({},i,{item:n.element});n.sortables=[],t(n.options.connectToSortable).each(function(){var i=t(this).sortable("instance");i&&!i.options.disabled&&(n.sortables.push(i),i.refreshPositions(),i._trigger("activate",e,o))})},stop:function(e,i,n){var o=t.extend({},i,{item:n.element});n.cancelHelperRemoval=!1,t.each(n.sortables,function(){var t=this;t.isOver?(t.isOver=0,n.cancelHelperRemoval=!0,t.cancelHelperRemoval=!1,t._storedCSS={position:t.placeholder.css("position"),top:t.placeholder.css("top"),left:t.placeholder.css("left")},t._mouseStop(e),t.options.helper=t.options._helper):(t.cancelHelperRemoval=!0,t._trigger("deactivate",e,o))})},drag:function(e,i,n){t.each(n.sortables,function(){var o=!1,s=this;s.positionAbs=n.positionAbs,s.helperProportions=n.helperProportions,s.offset.click=n.offset.click,s._intersectsWith(s.containerCache)&&(o=!0,t.each(n.sortables,function(){return this.positionAbs=n.positionAbs,this.helperProportions=n.helperProportions,this.offset.click=n.offset.click,this!==s&&this._intersectsWith(this.containerCache)&&t.contains(s.element[0],this.element[0])&&(o=!1),o})),o?(s.isOver||(s.isOver=1,n._parent=i.helper.parent(),s.currentItem=i.helper.appendTo(s.element).data("ui-sortable-item",!0),s.options._helper=s.options.helper,s.options.helper=function(){return i.helper[0]},e.target=s.currentItem[0],s._mouseCapture(e,!0),s._mouseStart(e,!0,!0),s.offset.click.top=n.offset.click.top,s.offset.click.left=n.offset.click.left,s.offset.parent.left-=n.offset.parent.left-s.offset.parent.left,s.offset.parent.top-=n.offset.parent.top-s.offset.parent.top,n._trigger("toSortable",e),n.dropped=s.element,t.each(n.sortables,function(){this.refreshPositions()}),n.currentItem=n.element,s.fromOutside=n),s.currentItem&&(s._mouseDrag(e),i.position=s.position)):s.isOver&&(s.isOver=0,s.cancelHelperRemoval=!0,s.options._revert=s.options.revert,s.options.revert=!1,s._trigger("out",e,s._uiHash(s)),s._mouseStop(e,!0),s.options.revert=s.options._revert,s.options.helper=s.options._helper,s.placeholder&&s.placeholder.remove(),i.helper.appendTo(n._parent),n._refreshOffsets(e),i.position=n._generatePosition(e,!0),n._trigger("fromSortable",e),n.dropped=!1,t.each(n.sortables,function(){this.refreshPositions()}))})}}),t.ui.plugin.add("draggable","cursor",{start:function(e,i,n){var o=t("body"),s=n.options;o.css("cursor")&&(s._cursor=o.css("cursor")),o.css("cursor",s.cursor)},stop:function(e,i,n){var o=n.options;o._cursor&&t("body").css("cursor",o._cursor)}}),t.ui.plugin.add("draggable","opacity",{start:function(e,i,n){var o=t(i.helper),s=n.options;o.css("opacity")&&(s._opacity=o.css("opacity")),o.css("opacity",s.opacity)},stop:function(e,i,n){var o=n.options;o._opacity&&t(i.helper).css("opacity",o._opacity)}}),t.ui.plugin.add("draggable","scroll",{start:function(t,e,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(e,i,n){var o=n.options,s=!1,a=n.scrollParentNotHidden[0],r=n.document[0];a!==r&&"HTML"!==a.tagName?(o.axis&&"x"===o.axis||(n.overflowOffset.top+a.offsetHeight-e.pageY<o.scrollSensitivity?a.scrollTop=s=a.scrollTop+o.scrollSpeed:e.pageY-n.overflowOffset.top<o.scrollSensitivity&&(a.scrollTop=s=a.scrollTop-o.scrollSpeed)),o.axis&&"y"===o.axis||(n.overflowOffset.left+a.offsetWidth-e.pageX<o.scrollSensitivity?a.scrollLeft=s=a.scrollLeft+o.scrollSpeed:e.pageX-n.overflowOffset.left<o.scrollSensitivity&&(a.scrollLeft=s=a.scrollLeft-o.scrollSpeed))):(o.axis&&"x"===o.axis||(e.pageY-t(r).scrollTop()<o.scrollSensitivity?s=t(r).scrollTop(t(r).scrollTop()-o.scrollSpeed):t(window).height()-(e.pageY-t(r).scrollTop())<o.scrollSensitivity&&(s=t(r).scrollTop(t(r).scrollTop()+o.scrollSpeed))),o.axis&&"y"===o.axis||(e.pageX-t(r).scrollLeft()<o.scrollSensitivity?s=t(r).scrollLeft(t(r).scrollLeft()-o.scrollSpeed):t(window).width()-(e.pageX-t(r).scrollLeft())<o.scrollSensitivity&&(s=t(r).scrollLeft(t(r).scrollLeft()+o.scrollSpeed)))),s!==!1&&t.ui.ddmanager&&!o.dropBehaviour&&t.ui.ddmanager.prepareOffsets(n,e)}}),t.ui.plugin.add("draggable","snap",{start:function(e,i,n){var o=n.options;n.snapElements=[],t(o.snap.constructor!==String?o.snap.items||":data(ui-draggable)":o.snap).each(function(){var e=t(this),i=e.offset();this!==n.element[0]&&n.snapElements.push({item:this,width:e.outerWidth(),height:e.outerHeight(),top:i.top,left:i.left})})},drag:function(e,i,n){var o,s,a,r,l,d,c,h,p,m,u=n.options,f=u.snapTolerance,g=i.offset.left,v=g+n.helperProportions.width,b=i.offset.top,w=b+n.helperProportions.height;for(p=n.snapElements.length-1;p>=0;p--)l=n.snapElements[p].left-n.margins.left,d=l+n.snapElements[p].width,c=n.snapElements[p].top-n.margins.top,h=c+n.snapElements[p].height,l-f>v||g>d+f||c-f>w||b>h+f||!t.contains(n.snapElements[p].item.ownerDocument,n.snapElements[p].item)?(n.snapElements[p].snapping&&n.options.snap.release&&n.options.snap.release.call(n.element,e,t.extend(n._uiHash(),{snapItem:n.snapElements[p].item})),n.snapElements[p].snapping=!1):("inner"!==u.snapMode&&(o=Math.abs(c-w)<=f,s=Math.abs(h-b)<=f,a=Math.abs(l-v)<=f,r=Math.abs(d-g)<=f,o&&(i.position.top=n._convertPositionTo("relative",{top:c-n.helperProportions.height,left:0}).top),s&&(i.position.top=n._convertPositionTo("relative",{top:h,left:0}).top),a&&(i.position.left=n._convertPositionTo("relative",{top:0,left:l-n.helperProportions.width}).left),r&&(i.position.left=n._convertPositionTo("relative",{top:0,left:d}).left)),m=o||s||a||r,"outer"!==u.snapMode&&(o=Math.abs(c-b)<=f,s=Math.abs(h-w)<=f,a=Math.abs(l-g)<=f,r=Math.abs(d-v)<=f,o&&(i.position.top=n._convertPositionTo("relative",{top:c,left:0}).top),s&&(i.position.top=n._convertPositionTo("relative",{top:h-n.helperProportions.height,left:0}).top),a&&(i.position.left=n._convertPositionTo("relative",{top:0,left:l}).left),r&&(i.position.left=n._convertPositionTo("relative",{top:0,left:d-n.helperProportions.width}).left)),!n.snapElements[p].snapping&&(o||s||a||r||m)&&n.options.snap.snap&&n.options.snap.snap.call(n.element,e,t.extend(n._uiHash(),{snapItem:n.snapElements[p].item})),n.snapElements[p].snapping=o||s||a||r||m)}}),t.ui.plugin.add("draggable","stack",{start:function(e,i,n){var o,s=n.options,a=t.makeArray(t(s.stack)).sort(function(e,i){return(parseInt(t(e).css("zIndex"),10)||0)-(parseInt(t(i).css("zIndex"),10)||0)});a.length&&(o=parseInt(t(a[0]).css("zIndex"),10)||0,t(a).each(function(e){t(this).css("zIndex",o+e)}),this.css("zIndex",o+a.length))}}),t.ui.plugin.add("draggable","zIndex",{start:function(e,i,n){var o=t(i.helper),s=n.options;o.css("zIndex")&&(s._zIndex=o.css("zIndex")),o.css("zIndex",s.zIndex)},stop:function(e,i,n){var o=n.options;o._zIndex&&t(i.helper).css("zIndex",o._zIndex)}}),t.ui.draggable}),/*!
 * jQuery UI Droppable 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/droppable/
 */
function(t){"function"==typeof define&&define.amd?define(["jquery","./core","./widget","./mouse","./draggable"],t):t(jQuery)}(function(t){return t.widget("ui.droppable",{version:"1.11.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,i=this.options,n=i.accept;this.isover=!1,this.isout=!0,this.accept=t.isFunction(n)?n:function(t){return t.is(n)},this.proportions=function(){return arguments.length?void(e=arguments[0]):e?e:e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},this._addToManager(i.scope),i.addClasses&&this.element.addClass("ui-droppable")},_addToManager:function(e){t.ui.ddmanager.droppables[e]=t.ui.ddmanager.droppables[e]||[],t.ui.ddmanager.droppables[e].push(this)},_splice:function(t){for(var e=0;e<t.length;e++)t[e]===this&&t.splice(e,1)},_destroy:function(){var e=t.ui.ddmanager.droppables[this.options.scope];this._splice(e),this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(e,i){if("accept"===e)this.accept=t.isFunction(i)?i:function(t){return t.is(i)};else if("scope"===e){var n=t.ui.ddmanager.droppables[this.options.scope];this._splice(n),this._addToManager(i)}this._super(e,i)},_activate:function(e){var i=t.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),i&&this._trigger("activate",e,this.ui(i))},_deactivate:function(e){var i=t.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),i&&this._trigger("deactivate",e,this.ui(i))},_over:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",e,this.ui(i)))},_out:function(e){var i=t.ui.ddmanager.current;i&&(i.currentItem||i.element)[0]!==this.element[0]&&this.accept.call(this.element[0],i.currentItem||i.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",e,this.ui(i)))},_drop:function(e,i){var n=i||t.ui.ddmanager.current,o=!1;return n&&(n.currentItem||n.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var i=t(this).droppable("instance");return i.options.greedy&&!i.options.disabled&&i.options.scope===n.options.scope&&i.accept.call(i.element[0],n.currentItem||n.element)&&t.ui.intersect(n,t.extend(i,{offset:i.element.offset()}),i.options.tolerance,e)?(o=!0,!1):void 0}),o?!1:this.accept.call(this.element[0],n.currentItem||n.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",e,this.ui(n)),this.element):!1):!1},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,offset:t.positionAbs}}}),t.ui.intersect=function(){function t(t,e,i){return t>=e&&e+i>t}return function(e,i,n,o){if(!i.offset)return!1;var s=(e.positionAbs||e.position.absolute).left+e.margins.left,a=(e.positionAbs||e.position.absolute).top+e.margins.top,r=s+e.helperProportions.width,l=a+e.helperProportions.height,d=i.offset.left,c=i.offset.top,h=d+i.proportions().width,p=c+i.proportions().height;switch(n){case"fit":return s>=d&&h>=r&&a>=c&&p>=l;case"intersect":return d<s+e.helperProportions.width/2&&r-e.helperProportions.width/2<h&&c<a+e.helperProportions.height/2&&l-e.helperProportions.height/2<p;case"pointer":return t(o.pageY,c,i.proportions().height)&&t(o.pageX,d,i.proportions().width);case"touch":return(a>=c&&p>=a||l>=c&&p>=l||c>a&&l>p)&&(s>=d&&h>=s||r>=d&&h>=r||d>s&&r>h);default:return!1}}}(),t.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(e,i){var n,o,s=t.ui.ddmanager.droppables[e.options.scope]||[],a=i?i.type:null,r=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();t:for(n=0;n<s.length;n++)if(!(s[n].options.disabled||e&&!s[n].accept.call(s[n].element[0],e.currentItem||e.element))){for(o=0;o<r.length;o++)if(r[o]===s[n].element[0]){s[n].proportions().height=0;continue t}s[n].visible="none"!==s[n].element.css("display"),s[n].visible&&("mousedown"===a&&s[n]._activate.call(s[n],i),s[n].offset=s[n].element.offset(),s[n].proportions({width:s[n].element[0].offsetWidth,height:s[n].element[0].offsetHeight}))}},drop:function(e,i){var n=!1;return t.each((t.ui.ddmanager.droppables[e.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&t.ui.intersect(e,this,this.options.tolerance,i)&&(n=this._drop.call(this,i)||n),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,i)))}),n},dragStart:function(e,i){e.element.parentsUntil("body").bind("scroll.droppable",function(){e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)})},drag:function(e,i){e.options.refreshPositions&&t.ui.ddmanager.prepareOffsets(e,i),t.each(t.ui.ddmanager.droppables[e.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var n,o,s,a=t.ui.intersect(e,this,this.options.tolerance,i),r=!a&&this.isover?"isout":a&&!this.isover?"isover":null;r&&(this.options.greedy&&(o=this.options.scope,s=this.element.parents(":data(ui-droppable)").filter(function(){return t(this).droppable("instance").options.scope===o}),s.length&&(n=t(s[0]).droppable("instance"),n.greedyChild="isover"===r)),n&&"isover"===r&&(n.isover=!1,n.isout=!0,n._out.call(n,i)),this[r]=!0,this["isout"===r?"isover":"isout"]=!1,this["isover"===r?"_over":"_out"].call(this,i),n&&"isout"===r&&(n.isout=!1,n.isover=!0,n._over.call(n,i)))}})},dragStop:function(e,i){e.element.parentsUntil("body").unbind("scroll.droppable"),e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,i)}},t.ui.droppable}),/*!
 * jQuery UI Selectable 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/selectable/
 */
function(t){"function"==typeof define&&define.amd?define(["jquery","./core","./mouse","./widget"],t):t(jQuery)}(function(t){return t.widget("ui.selectable",t.ui.mouse,{version:"1.11.4",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var e,i=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){e=t(i.options.filter,i.element[0]),e.addClass("ui-selectee"),e.each(function(){var e=t(this),i=e.offset();t.data(this,"selectable-item",{element:this,$element:e,left:i.left,top:i.top,right:i.left+e.outerWidth(),bottom:i.top+e.outerHeight(),startselected:!1,selected:e.hasClass("ui-selected"),selecting:e.hasClass("ui-selecting"),unselecting:e.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=e.addClass("ui-selectee"),this._mouseInit(),this.helper=t("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(e){var i=this,n=this.options;this.opos=[e.pageX,e.pageY],this.options.disabled||(this.selectees=t(n.filter,this.element[0]),this._trigger("start",e),t(n.appendTo).append(this.helper),this.helper.css({left:e.pageX,top:e.pageY,width:0,height:0}),n.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var n=t.data(this,"selectable-item");n.startselected=!0,e.metaKey||e.ctrlKey||(n.$element.removeClass("ui-selected"),n.selected=!1,n.$element.addClass("ui-unselecting"),n.unselecting=!0,i._trigger("unselecting",e,{unselecting:n.element}))}),t(e.target).parents().addBack().each(function(){var n,o=t.data(this,"selectable-item");return o?(n=!e.metaKey&&!e.ctrlKey||!o.$element.hasClass("ui-selected"),o.$element.removeClass(n?"ui-unselecting":"ui-selected").addClass(n?"ui-selecting":"ui-unselecting"),o.unselecting=!n,o.selecting=n,o.selected=n,n?i._trigger("selecting",e,{selecting:o.element}):i._trigger("unselecting",e,{unselecting:o.element}),!1):void 0}))},_mouseDrag:function(e){if(this.dragged=!0,!this.options.disabled){var i,n=this,o=this.options,s=this.opos[0],a=this.opos[1],r=e.pageX,l=e.pageY;return s>r&&(i=r,r=s,s=i),a>l&&(i=l,l=a,a=i),this.helper.css({left:s,top:a,width:r-s,height:l-a}),this.selectees.each(function(){var i=t.data(this,"selectable-item"),d=!1;i&&i.element!==n.element[0]&&("touch"===o.tolerance?d=!(i.left>r||i.right<s||i.top>l||i.bottom<a):"fit"===o.tolerance&&(d=i.left>s&&i.right<r&&i.top>a&&i.bottom<l),d?(i.selected&&(i.$element.removeClass("ui-selected"),i.selected=!1),i.unselecting&&(i.$element.removeClass("ui-unselecting"),i.unselecting=!1),i.selecting||(i.$element.addClass("ui-selecting"),i.selecting=!0,n._trigger("selecting",e,{selecting:i.element}))):(i.selecting&&((e.metaKey||e.ctrlKey)&&i.startselected?(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.$element.addClass("ui-selected"),i.selected=!0):(i.$element.removeClass("ui-selecting"),i.selecting=!1,i.startselected&&(i.$element.addClass("ui-unselecting"),i.unselecting=!0),n._trigger("unselecting",e,{unselecting:i.element}))),i.selected&&(e.metaKey||e.ctrlKey||i.startselected||(i.$element.removeClass("ui-selected"),i.selected=!1,i.$element.addClass("ui-unselecting"),i.unselecting=!0,n._trigger("unselecting",e,{unselecting:i.element})))))}),!1}},_mouseStop:function(e){var i=this;return this.dragged=!1,t(".ui-unselecting",this.element[0]).each(function(){var n=t.data(this,"selectable-item");n.$element.removeClass("ui-unselecting"),n.unselecting=!1,n.startselected=!1,i._trigger("unselected",e,{unselected:n.element})}),t(".ui-selecting",this.element[0]).each(function(){var n=t.data(this,"selectable-item");n.$element.removeClass("ui-selecting").addClass("ui-selected"),n.selecting=!1,n.selected=!0,n.startselected=!0,i._trigger("selected",e,{selected:n.element})}),this._trigger("stop",e),this.helper.remove(),!1}})}),/*!
 * jQuery UI Sortable 1.11.4
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/sortable/
 */
function(t){"function"==typeof define&&define.amd?define(["jquery","./core","./mouse","./widget"],t):t(jQuery)}(function(t){return t.widget("ui.sortable",t.ui.mouse,{version:"1.11.4",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(t,e,i){return t>=e&&e+i>t},_isFloating:function(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))},_create:function(){this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(t,e){this._super(t,e),"handle"===t&&this._setHandleClassName()},_setHandleClassName:function(){this.element.find(".ui-sortable-handle").removeClass("ui-sortable-handle"),t.each(this.items,function(){(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item).addClass("ui-sortable-handle")})},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").find(".ui-sortable-handle").removeClass("ui-sortable-handle"),this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(e,i){var n=null,o=!1,s=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(e),t(e.target).parents().each(function(){return t.data(this,s.widgetName+"-item")===s?(n=t(this),!1):void 0}),t.data(e.target,s.widgetName+"-item")===s&&(n=t(e.target)),n&&(!this.options.handle||i||(t(this.options.handle,n).find("*").addBack().each(function(){this===e.target&&(o=!0)}),o))?(this.currentItem=n,this._removeCurrentsFromItems(),!0):!1)},_mouseStart:function(e,i,n){var o,s,a=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,a.cursorAt&&this._adjustOffsetFromHelper(a.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),a.containment&&this._setContainment(),a.cursor&&"auto"!==a.cursor&&(s=this.document.find("body"),this.storedCursor=s.css("cursor"),s.css("cursor",a.cursor),this.storedStylesheet=t("<style>*{ cursor: "+a.cursor+" !important; }</style>").appendTo(s)),a.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",a.opacity)),a.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",a.zIndex)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!n)for(o=this.containers.length-1;o>=0;o--)this.containers[o]._trigger("activate",e,this._uiHash(this));return t.ui.ddmanager&&(t.ui.ddmanager.current=this),t.ui.ddmanager&&!a.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){var i,n,o,s,a=this.options,r=!1;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<a.scrollSensitivity?this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop+a.scrollSpeed:e.pageY-this.overflowOffset.top<a.scrollSensitivity&&(this.scrollParent[0].scrollTop=r=this.scrollParent[0].scrollTop-a.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<a.scrollSensitivity?this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft+a.scrollSpeed:e.pageX-this.overflowOffset.left<a.scrollSensitivity&&(this.scrollParent[0].scrollLeft=r=this.scrollParent[0].scrollLeft-a.scrollSpeed)):(e.pageY-this.document.scrollTop()<a.scrollSensitivity?r=this.document.scrollTop(this.document.scrollTop()-a.scrollSpeed):this.window.height()-(e.pageY-this.document.scrollTop())<a.scrollSensitivity&&(r=this.document.scrollTop(this.document.scrollTop()+a.scrollSpeed)),e.pageX-this.document.scrollLeft()<a.scrollSensitivity?r=this.document.scrollLeft(this.document.scrollLeft()-a.scrollSpeed):this.window.width()-(e.pageX-this.document.scrollLeft())<a.scrollSensitivity&&(r=this.document.scrollLeft(this.document.scrollLeft()+a.scrollSpeed))),r!==!1&&t.ui.ddmanager&&!a.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),i=this.items.length-1;i>=0;i--)if(n=this.items[i],o=n.item[0],s=this._intersectsWithPointer(n),s&&n.instance===this.currentContainer&&o!==this.currentItem[0]&&this.placeholder[1===s?"next":"prev"]()[0]!==o&&!t.contains(this.placeholder[0],o)&&("semi-dynamic"===this.options.type?!t.contains(this.element[0],o):!0)){if(this.direction=1===s?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(n))break;this._rearrange(e,n),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,i){if(e){if(t.ui.ddmanager&&!this.options.dropBehaviour&&t.ui.ddmanager.drop(this,e),this.options.revert){var n=this,o=this.placeholder.offset(),s=this.options.axis,a={};s&&"x"!==s||(a.left=o.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),s&&"y"!==s||(a.top=o.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,t(this.helper).animate(a,parseInt(this.options.revert,10)||500,function(){n._clear(e)})}else this._clear(e,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),t.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?t(this.domPosition.prev).after(this.currentItem):t(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var i=this._getItemsAsjQuery(e&&e.connected),n=[];return e=e||{},t(i).each(function(){var i=(t(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);i&&n.push((e.key||i[1]+"[]")+"="+(e.key&&e.expression?i[1]:i[2]))}),!n.length&&e.key&&n.push(e.key+"="),n.join("&")},toArray:function(e){var i=this._getItemsAsjQuery(e&&e.connected),n=[];return e=e||{},i.each(function(){n.push(t(e.item||this).attr(e.attribute||"id")||"")}),n},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,n=this.positionAbs.top,o=n+this.helperProportions.height,s=t.left,a=s+t.width,r=t.top,l=r+t.height,d=this.offset.click.top,c=this.offset.click.left,h="x"===this.options.axis||n+d>r&&l>n+d,p="y"===this.options.axis||e+c>s&&a>e+c,m=h&&p;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?m:s<e+this.helperProportions.width/2&&i-this.helperProportions.width/2<a&&r<n+this.helperProportions.height/2&&o-this.helperProportions.height/2<l},_intersectsWithPointer:function(t){var e="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),i="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width),n=e&&i,o=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();return n?this.floating?s&&"right"===s||"down"===o?2:1:o&&("down"===o?2:1):!1},_intersectsWithSides:function(t){var e=this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),n=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return this.floating&&o?"right"===o&&i||"left"===o&&!i:n&&("down"===n&&e||"up"===n&&!e)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!==t&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!==t&&(t>0?"right":"left")},refresh:function(t){return this._refreshItems(t),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(e){function i(){r.push(this)}var n,o,s,a,r=[],l=[],d=this._connectWith();if(d&&e)for(n=d.length-1;n>=0;n--)for(s=t(d[n],this.document[0]),o=s.length-1;o>=0;o--)a=t.data(s[o],this.widgetFullName),a&&a!==this&&!a.options.disabled&&l.push([t.isFunction(a.options.items)?a.options.items.call(a.element):t(a.options.items,a.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),a]);for(l.push([t.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):t(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),n=l.length-1;n>=0;n--)l[n][0].each(i);return t(r)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=t.grep(this.items,function(t){for(var i=0;i<e.length;i++)if(e[i]===t.item[0])return!1;return!0})},_refreshItems:function(e){this.items=[],this.containers=[this];var i,n,o,s,a,r,l,d,c=this.items,h=[[t.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):t(this.options.items,this.element),this]],p=this._connectWith();if(p&&this.ready)for(i=p.length-1;i>=0;i--)for(o=t(p[i],this.document[0]),n=o.length-1;n>=0;n--)s=t.data(o[n],this.widgetFullName),s&&s!==this&&!s.options.disabled&&(h.push([t.isFunction(s.options.items)?s.options.items.call(s.element[0],e,{item:this.currentItem}):t(s.options.items,s.element),s]),this.containers.push(s));for(i=h.length-1;i>=0;i--)for(a=h[i][1],r=h[i][0],n=0,d=r.length;d>n;n++)l=t(r[n]),l.data(this.widgetName+"-item",a),c.push({item:l,instance:a,width:0,height:0,left:0,top:0})},refreshPositions:function(e){this.floating=this.items.length?"x"===this.options.axis||this._isFloating(this.items[0].item):!1,this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var i,n,o,s;for(i=this.items.length-1;i>=0;i--)n=this.items[i],n.instance!==this.currentContainer&&this.currentContainer&&n.item[0]!==this.currentItem[0]||(o=this.options.toleranceElement?t(this.options.toleranceElement,n.item):n.item,e||(n.width=o.outerWidth(),n.height=o.outerHeight()),s=o.offset(),n.left=s.left,n.top=s.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(i=this.containers.length-1;i>=0;i--)s=this.containers[i].element.offset(),this.containers[i].containerCache.left=s.left,this.containers[i].containerCache.top=s.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight();return this},_createPlaceholder:function(e){e=e||this;var i,n=e.options;n.placeholder&&n.placeholder.constructor!==String||(i=n.placeholder,n.placeholder={element:function(){var n=e.currentItem[0].nodeName.toLowerCase(),o=t("<"+n+">",e.document[0]).addClass(i||e.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tbody"===n?e._createTrPlaceholder(e.currentItem.find("tr").eq(0),t("<tr>",e.document[0]).appendTo(o)):"tr"===n?e._createTrPlaceholder(e.currentItem,o):"img"===n&&o.attr("src",e.currentItem.attr("src")),i||o.css("visibility","hidden"),o},update:function(t,o){(!i||n.forcePlaceholderSize)&&(o.height()||o.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),o.width()||o.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10)))}}),e.placeholder=t(n.placeholder.element.call(e.element,e.currentItem)),e.currentItem.after(e.placeholder),n.placeholder.update(e,e.placeholder)},_createTrPlaceholder:function(e,i){var n=this;e.children().each(function(){t("<td>&#160;</td>",n.document[0]).attr("colspan",t(this).attr("colspan")||1).appendTo(i)})},_contactContainers:function(e){var i,n,o,s,a,r,l,d,c,h,p=null,m=null;for(i=this.containers.length-1;i>=0;i--)if(!t.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(p&&t.contains(this.containers[i].element[0],p.element[0]))continue;p=this.containers[i],m=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",e,this._uiHash(this)),this.containers[i].containerCache.over=0);if(p)if(1===this.containers.length)this.containers[m].containerCache.over||(this.containers[m]._trigger("over",e,this._uiHash(this)),this.containers[m].containerCache.over=1);else{for(o=1e4,s=null,c=p.floating||this._isFloating(this.currentItem),a=c?"left":"top",r=c?"width":"height",h=c?"clientX":"clientY",n=this.items.length-1;n>=0;n--)t.contains(this.containers[m].element[0],this.items[n].item[0])&&this.items[n].item[0]!==this.currentItem[0]&&(l=this.items[n].item.offset()[a],d=!1,e[h]-l>this.items[n][r]/2&&(d=!0),Math.abs(e[h]-l)<o&&(o=Math.abs(e[h]-l),s=this.items[n],this.direction=d?"up":"down"));if(!s&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[m])return void(this.currentContainer.containerCache.over||(this.containers[m]._trigger("over",e,this._uiHash()),this.currentContainer.containerCache.over=1));s?this._rearrange(e,s,null,!0):this._rearrange(e,null,this.containers[m].element,!0),this._trigger("change",e,this._uiHash()),this.containers[m]._trigger("change",e,this._uiHash(this)),this.currentContainer=this.containers[m],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[m]._trigger("over",e,this._uiHash(this)),this.containers[m].containerCache.over=1}},_createHelper:function(e){var i=this.options,n=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return n.parents("body").length||t("parent"!==i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(n[0]),n[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!n[0].style.width||i.forceHelperSize)&&n.width(this.currentItem.width()),(!n[0].style.height||i.forceHelperSize)&&n.height(this.currentItem.height()),n},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,n,o=this.options;"parent"===o.containment&&(o.containment=this.helper[0].parentNode),("document"===o.containment||"window"===o.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===o.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===o.containment?this.document.width():this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(o.containment)||(e=t(o.containment)[0],i=t(o.containment).offset(),n="hidden"!==t(e).css("overflow"),this.containment=[i.left+(parseInt(t(e).css("borderLeftWidth"),10)||0)+(parseInt(t(e).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(t(e).css("borderTopWidth"),10)||0)+(parseInt(t(e).css("paddingTop"),10)||0)-this.margins.top,i.left+(n?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(t(e).css("borderLeftWidth"),10)||0)-(parseInt(t(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(n?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(t(e).css("borderTopWidth"),10)||0)-(parseInt(t(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,i){i||(i=this.position);var n="absolute"===e?1:-1,o="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(o[0].tagName);return{top:i.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():s?0:o.scrollTop())*n,left:i.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():s?0:o.scrollLeft())*n}},_generatePosition:function(e){var i,n,o=this.options,s=e.pageX,a=e.pageY,r="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(r[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(s=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(a=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(s=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(a=this.containment[3]+this.offset.click.top)),o.grid&&(i=this.originalPageY+Math.round((a-this.originalPageY)/o.grid[1])*o.grid[1],a=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-o.grid[1]:i+o.grid[1]:i,n=this.originalPageX+Math.round((s-this.originalPageX)/o.grid[0])*o.grid[0],s=this.containment?n-this.offset.click.left>=this.containment[0]&&n-this.offset.click.left<=this.containment[2]?n:n-this.offset.click.left>=this.containment[0]?n-o.grid[0]:n+o.grid[0]:n)),{top:a-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:r.scrollTop()),left:s-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:r.scrollLeft())}},_rearrange:function(t,e,i,n){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var o=this.counter;this._delay(function(){o===this.counter&&this.refreshPositions(!n)})},_clear:function(t,e){function i(t,e,i){return function(n){i._trigger(t,n,e._uiHash(e))}}this.reverting=!1;var n,o=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(n in this._storedCSS)("auto"===this._storedCSS[n]||"static"===this._storedCSS[n])&&(this._storedCSS[n]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!e&&o.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||o.push(function(t){this._trigger("update",t,this._uiHash())}),this!==this.currentContainer&&(e||(o.push(function(t){this._trigger("remove",t,this._uiHash())}),o.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),o.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer)))),n=this.containers.length-1;n>=0;n--)e||o.push(i("deactivate",this,this.containers[n])),this.containers[n].containerCache.over&&(o.push(i("out",this,this.containers[n])),this.containers[n].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!e){for(n=0;n<o.length;n++)o[n].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){t.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(e){var i=e||this;return{helper:i.helper,placeholder:i.placeholder||t([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:e?e.element:null}}})}),/*!
 * imagesLoaded PACKAGED v4.1.1
 * JavaScript is all like "You images are done yet or what?"
 * MIT License
 */
function(t,e){"function"==typeof define&&define.amd?define("ev-emitter/ev-emitter",e):"object"==typeof module&&module.exports?module.exports=e():t.EvEmitter=e()}("undefined"!=typeof window?window:this,function(){function t(){}var e=t.prototype;return e.on=function(t,e){if(t&&e){var i=this._events=this._events||{},n=i[t]=i[t]||[];return-1==n.indexOf(e)&&n.push(e),this}},e.once=function(t,e){if(t&&e){this.on(t,e);var i=this._onceEvents=this._onceEvents||{},n=i[t]=i[t]||{};return n[e]=!0,this}},e.off=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=i.indexOf(e);return-1!=n&&i.splice(n,1),this}},e.emitEvent=function(t,e){var i=this._events&&this._events[t];if(i&&i.length){var n=0,o=i[n];e=e||[];for(var s=this._onceEvents&&this._onceEvents[t];o;){var a=s&&s[o];a&&(this.off(t,o),delete s[o]),o.apply(this,e),n+=a?0:1,o=i[n]}return this}},t}),/*!
 * imagesLoaded v4.1.1
 * JavaScript is all like "You images are done yet or what?"
 * MIT License
 */
function(t,e){"use strict";"function"==typeof define&&define.amd?define(["ev-emitter/ev-emitter"],function(i){return e(t,i)}):"object"==typeof module&&module.exports?module.exports=e(t,require("ev-emitter")):t.imagesLoaded=e(t,t.EvEmitter)}(window,function(t,e){function i(t,e){for(var i in e)t[i]=e[i];return t}function n(t){var e=[];if(Array.isArray(t))e=t;else if("number"==typeof t.length)for(var i=0;i<t.length;i++)e.push(t[i]);else e.push(t);return e}function o(t,e,s){return this instanceof o?("string"==typeof t&&(t=document.querySelectorAll(t)),this.elements=n(t),this.options=i({},this.options),"function"==typeof e?s=e:i(this.options,e),s&&this.on("always",s),this.getImages(),r&&(this.jqDeferred=new r.Deferred),void setTimeout(function(){this.check()}.bind(this))):new o(t,e,s)}function s(t){this.img=t}function a(t,e){this.url=t,this.element=e,this.img=new Image}var r=t.jQuery,l=t.console;o.prototype=Object.create(e.prototype),o.prototype.options={},o.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},o.prototype.addElementImages=function(t){"IMG"==t.nodeName&&this.addImage(t),this.options.background===!0&&this.addElementBackgroundImages(t);var e=t.nodeType;if(e&&d[e]){for(var i=t.querySelectorAll("img"),n=0;n<i.length;n++){var o=i[n];this.addImage(o)}if("string"==typeof this.options.background){var s=t.querySelectorAll(this.options.background);for(n=0;n<s.length;n++){var a=s[n];this.addElementBackgroundImages(a)}}}};var d={1:!0,9:!0,11:!0};return o.prototype.addElementBackgroundImages=function(t){var e=getComputedStyle(t);if(e)for(var i=/url\((['"])?(.*?)\1\)/gi,n=i.exec(e.backgroundImage);null!==n;){var o=n&&n[2];o&&this.addBackground(o,t),n=i.exec(e.backgroundImage)}},o.prototype.addImage=function(t){var e=new s(t);this.images.push(e)},o.prototype.addBackground=function(t,e){var i=new a(t,e);this.images.push(i)},o.prototype.check=function(){function t(t,i,n){setTimeout(function(){e.progress(t,i,n)})}var e=this;return this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?void this.images.forEach(function(e){e.once("progress",t),e.check()}):void this.complete()},o.prototype.progress=function(t,e,i){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!t.isLoaded,this.emitEvent("progress",[this,t,e]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,t),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&l&&l.log("progress: "+i,t,e)},o.prototype.complete=function(){var t=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emitEvent(t,[this]),this.emitEvent("always",[this]),this.jqDeferred){var e=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[e](this)}},s.prototype=Object.create(e.prototype),s.prototype.check=function(){var t=this.getIsImageComplete();return t?void this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),void(this.proxyImage.src=this.img.src))},s.prototype.getIsImageComplete=function(){return this.img.complete&&void 0!==this.img.naturalWidth},s.prototype.confirm=function(t,e){this.isLoaded=t,this.emitEvent("progress",[this,this.img,e])},s.prototype.handleEvent=function(t){var e="on"+t.type;this[e]&&this[e](t)},s.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},s.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},s.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},a.prototype=Object.create(s.prototype),a.prototype.check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url;var t=this.getIsImageComplete();t&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},a.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},a.prototype.confirm=function(t,e){this.isLoaded=t,this.emitEvent("progress",[this,this.element,e])},o.makeJQueryPlugin=function(e){e=e||t.jQuery,e&&(r=e,r.fn.imagesLoaded=function(t,e){var i=new o(this,t,e);return i.jqDeferred.promise(r(this))})},o.makeJQueryPlugin(),o}),/*
 * Undo.js - A undo/redo framework for JavaScript
 *
 * http://jzaefferer.github.com/undo
 *
 * Copyright (c) 2011 Jörn Zaefferer
 *
 * MIT licensed.
 */
function(){function t(t,e){var i,n;for(i in e)n=e[i],void 0!==n&&(t[i]=n);return t}var e=function(){},i=function(i,n){var o;return o=n&&n.hasOwnProperty("constructor")?n.constructor:function(){return i.apply(this,arguments)},e.prototype=i.prototype,o.prototype=new e,n&&t(o.prototype,n),o.prototype.constructor=o,o.__super__=i.prototype,o},n={version:"0.1.15"};n.Stack=function(){this.commands=[],this.stackPosition=-1,this.savePosition=-1},t(n.Stack.prototype,{execute:function(t){this._clearRedo(),t.execute(),this.commands.push(t),this.stackPosition++,this.changed()},undo:function(){this.commands[this.stackPosition].undo(),this.stackPosition--,this.changed()},canUndo:function(){return this.stackPosition>=0},redo:function(){this.stackPosition++,this.commands[this.stackPosition].redo(),this.changed()},canRedo:function(){return this.stackPosition<this.commands.length-1},save:function(){this.savePosition=this.stackPosition,this.changed()},dirty:function(){return this.stackPosition!=this.savePosition},_clearRedo:function(){this.commands=this.commands.slice(0,this.stackPosition+1)},changed:function(){}}),n.Command=function(t){this.name=t};var o=new Error("override me!");t(n.Command.prototype,{execute:function(){throw o},undo:function(){throw o},redo:function(){this.execute()}}),n.Command.extend=function(t){var e=i(this,t);return e.extend=n.Command.extend,e},"function"==typeof define&&define.amd?define(n):"undefined"!=typeof module&&module.exports?module.exports=n:this.Undo=n}.call(this),/*!
 * jQuery UI Touch Punch 0.2.3
 *
 * Copyright 2011–2014, Dave Furfero
 * Dual licensed under the MIT or GPL Version 2 licenses.
 *
 * Depends:
 *  jquery.ui.widget.js
 *  jquery.ui.mouse.js
 */
function(t){function e(t,e){if(!(t.originalEvent.touches.length>1)){t.preventDefault();var i=t.originalEvent.changedTouches[0],n=document.createEvent("MouseEvents");n.initMouseEvent(e,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),t.target.dispatchEvent(n)}}if(t.support.touch="ontouchend"in document,t.support.touch){var i,n=t.ui.mouse.prototype,o=n._mouseInit,s=n._mouseDestroy;n._touchStart=function(t){var n=this;!i&&n._mouseCapture(t.originalEvent.changedTouches[0])&&(i=!0,n._touchMoved=!1,e(t,"mouseover"),e(t,"mousemove"),e(t,"mousedown"))},n._touchMove=function(t){i&&(this._touchMoved=!0,e(t,"mousemove"))},n._touchEnd=function(t){i&&(e(t,"mouseup"),e(t,"mouseout"),this._touchMoved||e(t,"click"),i=!1)},n._mouseInit=function(){var e=this;e.element.bind({touchstart:t.proxy(e,"_touchStart"),touchmove:t.proxy(e,"_touchMove"),touchend:t.proxy(e,"_touchEnd")}),o.call(e)},n._mouseDestroy=function(){var e=this;e.element.unbind({touchstart:t.proxy(e,"_touchStart"),touchmove:t.proxy(e,"_touchMove"),touchend:t.proxy(e,"_touchEnd")}),s.call(e)}}}(jQuery);var cb_list="",cb_edit=!0,cb_snippetList="#divSnippetList",cb_snippetPageSliding=!1,sScriptPath="/assets/",sc=document.createElement("script");sc.src=sScriptPath+"load-image.all.min.js",document.getElementsByTagName("head")[0].appendChild(sc),function(t){var i;t.contentbuilder=function(n,o){var s={zoom:"1",selectable:"h1,h2,h3,h4,h5,h6,p,blockquote,ul,ol,small,.edit",editMode:"default",onRender:function(){},changeCallback:function(){},onDrop:function(){},onImageBrowseClick:function(){},onImageSettingClick:function(){},snippetFile:"assets/default/snippets.html",snippetPathReplace:["",""],hiquality:!1,snippetTool:"right",snippetOpen:!1,snippetOpenCallback:function(){},snippetPageSliding:!1,scrollHelper:!1,snippetCategories:[[0,"Default"],[-1,"All"],[1,"Profile"],[6,"Paragraph"],[11,"Images"],[14,"List"],[15,"Quotes"],[20,"Video"],[32,"Slide"],[19,"Separator"]],imageselect:"",fileselect:"",onImageSelectClick:function(){},onFileSelectClick:function(){},iconSelect:"",imageEmbed:!0,sourceEditor:!0,enableZoom:!1,colors:["#ffffc5","#e9d4a7","#ffd5d5","#ffd4df","#c5efff","#b4fdff","#c6f5c6","#fcd1fe","#ececec","#f7e97a","#d09f5e","#ff8d8d","#ff80aa","#63d3ff","#7eeaed","#94dd95","#ef97f3","#d4d4d4","#fed229","#cc7f18","#ff0e0e","#fa4273","#00b8ff","#0edce2","#35d037","#d24fd7","#888888","#ff9c26","#955705","#c31313","#f51f58","#1b83df","#0bbfc5","#1aa71b","#ae19b4","#4a4a4a"],snippetList:"#divSnippetList",toolbar:"top",toolbarDisplay:"auto",axis:"",hideDragPreview:!1,customval:0,largerImageHandler:"",onVideoTypeNotSupported:function(){}};this.settings={};var a=t(n),n=n;this.init=function(){this.settings=t.extend({},s,o),(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i))&&(this.settings.enableZoom=!1);var i=detectEdge();if(i&&(this.settings.enableZoom=!1),this.settings.enableZoom||(localStorage.removeItem("zoom"),this.settings.zoom=1,localStorage.zoom=1),null!=localStorage.getItem("zoom")?this.settings.zoom=localStorage.zoom:localStorage.zoom=this.settings.zoom,a.css("zoom",this.settings.zoom),a.css("-moz-transform","scale("+this.settings.zoom+")"),a.addClass("connectSortable"),this.settings.zoom=this.settings.zoom+"",-1!=this.settings.zoom.indexOf("%")&&(this.settings.zoom=this.settings.zoom.replace("%","")/100,localStorage.zoom=this.settings.zoom),"NaN"==this.settings.zoom&&(this.settings.zoom=1,localStorage.zoom=1),cb_list=""==cb_list?"#"+a.attr("id"):cb_list+",#"+a.attr("id"),cb_snippetList=this.settings.snippetList,cb_snippetPageSliding=this.settings.snippetPageSliding,a.css({"min-height":"50px"}),0==t("#divCb").length&&t("body").append('<div id="divCb"></div>'),0==t("#divSnippets").length){t("#divCb").append('<div id="divSnippets" style="display:none"></div>');for(var n="",r=0;r<this.settings.snippetCategories.length;r++)n+='<option value="'+this.settings.snippetCategories[r][0]+'">'+this.settings.snippetCategories[r][1]+"</option>";n='<select id="selSnips">'+n+"</select>";var l='<div id="divTool">'+n;l+='<div id="divSnippetList"></div>',l+="",l+='<br><div id="divRange"><input type="range" id="inpZoom" min="80" max="100" value="100"></div>',l+="",l+='<a id="lnkToolOpen" href="#"><i class="fa fa-chevron-left" style="font-size: 15px;"></i></a></div>',l+='<div id="divSnippetScrollUp" style="display:none;background:rgba(0,0,0,0.3);width:45px;height:45px;line-height:45px;color:#eee;position:fixed;z-index:100000;border-radius:8px;text-align:center;font-size:12px;cursor:pointer;font-family:sans-serif;">&#9650;</div><div id="divSnippetScrollDown" style="display:none;background:rgba(0,0,0,0.3);width:45px;height:45px;line-height:45px;color:#eee;position:fixed;z-index:100000;border-radius:8px;text-align:center;font-size:12px;cursor:pointer;font-family:sans-serif;">&#9660;</div>',t("#divCb").append(l),t("#inpZoom").val(100*this.settings.zoom);var d=t("#inpZoom").val()/100;this.zoom(d),t("#inpZoom").on("change",function(){if(1==a.data("contentbuilder").settings.enableZoom){var e=t("#inpZoom").val()/100;a.data("contentbuilder").zoom(e)}}),t.get(this.settings.snippetFile,function(e){var i="",n="",o=1,s=!1;if(""!=a.data("contentbuilder").settings.snippetPathReplace[0]){var r=new RegExp(a.data("contentbuilder").settings.snippetPathReplace[0],"g");e=e.replace(r,a.data("contentbuilder").settings.snippetPathReplace[1])}if(t("<div/>").html(e).children("div").each(function(){var e=t(this).html(),a=t("<div/>").text(e).html();i+='<div id="snip'+o+'">'+a+"</div>",null!=t(this).data("cat")&&(s=!0);var r=t(this).data("thumb"),l=t(this).data("medium"),d="";s&&(d='style="display:none"');var c="";void 0!=t(this).data("locked")&&(c='class="locked"'),n+="<div "+d+" "+c+' data-snip="'+o+'" data-cat="'+t(this).data("cat")+'"><img src="'+r+'" data-medium="'+l+'" data-no-retina /></div>',o++}),t("#divSnippets").html(i),t(cb_snippetList).html(n),s){var l=[],d=!1;t(cb_snippetList+" > div").each(function(){for(var e=0;e<t(this).attr("data-cat").split(",").length;e++){var i=t(this).attr("data-cat").split(",")[e];0==i&&(t(this).fadeIn(400),d=!0),-1==t.inArray(i,l)&&l.push(i)}}),t("#selSnips option").each(function(){var e=t(this).attr("value");-1==t.inArray(e,l)&&0!=e&&-1!=e&&t("#selSnips option[value='"+e+"']").remove()}),d||(t(cb_snippetList+" > div").css("display","block"),t("#selSnips option[value='0']").remove()),t("#selSnips").css("display","block"),t("#selSnips").on("change",function(e){var i=(t("option:selected",this),this.value);"-1"==i?t(cb_snippetList+" > div").fadeIn(200):t(cb_snippetList+" > div").fadeOut(200,function(){for(var e=0;e<t(this).attr("data-cat").split(",").length;e++)i==t(this).attr("data-cat").split(",")[e]&&t(this).fadeIn(400)})})}"#divSnippetList"==cb_snippetList&&s&&t("#divSnippetList").css("border-top","rgba(0,0,0,0) 45px solid"),a.data("contentbuilder").applyDraggable()})}else this.applyDraggable();var c=1e8;t("#divSnippetScrollUp").css("display","none"),t("#divSnippetScrollUp").bind("click touchup",function(){return t("#divSnippetList").animate({scrollTop:t("#divSnippetList").scrollTop()-(t("#divSnippetList").height()-150)+"px"},300,function(){0!=t("#divSnippetList").scrollTop()?t("#divSnippetScrollUp").fadeIn(300):t("#divSnippetScrollUp").fadeOut(300),t("#divSnippetList").scrollTop()!=c?t("#divSnippetScrollDown").fadeIn(300):t("#divSnippetScrollDown").fadeOut(300)}),e.preventDefault(),e.stopImmediatePropagation(),!1}),t("#divSnippetScrollDown").bind("click touchup",function(){return t("#divSnippetList").animate({scrollTop:t("#divSnippetList").scrollTop()+(t("#divSnippetList").height()-150)+"px"},300,function(){0!=t("#divSnippetList").scrollTop()?t("#divSnippetScrollUp").fadeIn(300):t("#divSnippetScrollUp").fadeOut(300),1e8==c&&(c=t("#divSnippetList").prop("scrollHeight")-t("#divSnippetList").height()-10),t("#divSnippetList").scrollTop()!=c?t("#divSnippetScrollDown").fadeIn(300):t("#divSnippetScrollDown").fadeOut(300)}),e.preventDefault(),e.stopImmediatePropagation(),!1}),a.children("*").wrap("<div class='ui-draggable'></div>"),a.children("*").append('<div class="toolbar-row toolbar"><div class="row-handle"><i class="fa fa-arrows"></i></div><div class="row-html"><i class="fa fa-code"></i></div><div class="row-copy"><i class="fa fa-plus-square-o"></i></div><div class="row-remove"><i class="fa fa-minus-square-o"></i></div></div>'),0==t("#temp-contentbuilder").length&&t("#divCb").append('<div id="temp-contentbuilder" style="display: none"></div>');var h=t(window),p=h.width(),m=260;600>p&&(m=150),320>=p&&(a.css("margin-left","35px"),a.css("margin-right","35px"),a.css("width","80%"));var u=this.settings.scrollHelper;(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i))&&(u=!0),"right"==this.settings.snippetTool?(t("#divSnippetScrollUp").css("right","10px"),t("#divSnippetScrollDown").css("right","10px"),"0px"!=t("#divTool").css("right")&&(t("#divTool").css("width",m+"px"),t("#divTool").css("right","-"+m+"px")),t("#lnkToolOpen").unbind("click"),t("#lnkToolOpen").click(function(e){if(t(".toolbar-row").stop(!0,!0).fadeOut(0),t(".ui-draggable").removeClass("code"),t(".ui-draggable").removeClass("ui-dragbox-outlined"),t("#rte-toolbar").css("display","none"),cb_snippetPageSliding||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)){if(0==parseInt(t("#divTool").css("right")))t("#divTool").animate({right:"-="+m+"px"},200),t("body").animate({marginRight:"-="+m+"px"},250),t("#rte-toolbar").animate({paddingRight:"-="+m+"px"},250),t("#lnkToolOpen i").attr("class","fa fa-chevron-left"),t("#divSnippetScrollUp").fadeOut(300),t("#divSnippetScrollDown").fadeOut(300);else if(t("#divTool").animate({right:"+="+m+"px"},200),t("body").animate({marginRight:"+="+m+"px"},250),t("#rte-toolbar").animate({paddingRight:"+="+m+"px"},250),t("#lnkToolOpen i").attr("class","fa fa-chevron-right"),u){var i=t("#divSnippetList").height()/2-60;t("#divSnippetScrollUp").css("top",i),t("#divSnippetScrollDown").css("top",i+60),0!=t("#divSnippetList").scrollTop()?t("#divSnippetScrollUp").fadeIn(300):t("#divSnippetScrollUp").fadeOut(300),t("#divSnippetScrollDown").fadeIn(300)}t("#rte-toolbar").css("display","none")}else if(0==parseInt(t("#divTool").css("right")))t("#divTool").animate({right:"-="+m+"px"},200),t("#lnkToolOpen i").attr("class","fa fa-chevron-left"),t("#divSnippetScrollUp").css("display","none"),t("#divSnippetScrollDown").css("display","none");else if(t("#divTool").animate({right:"+="+m+"px"},200),t("#lnkToolOpen i").attr("class","fa fa-chevron-right"),u){var i=t("#divSnippetList").height()/2-60;t("#divSnippetScrollUp").css("top",i),t("#divSnippetScrollDown").css("top",i+60),0!=t("#divSnippetList").scrollTop()?t("#divSnippetScrollUp").fadeIn(300):t("#divSnippetScrollUp").fadeOut(300),t("#divSnippetScrollDown").fadeIn(300)}e.preventDefault()}),t(".toolbar-row").css("right","auto"),600>p?t(".toolbar-row").css("left","-30px"):t(".toolbar-row").css("left","-37px"),this.settings.snippetOpen&&1!=t("#divTool").attr("data-snip-open")&&(t("#divTool").attr("data-snip-open",1),t("#divTool").animate({right:"+="+m+"px"},900,"swing",this.settings.snippetOpenCallback),t("#lnkToolOpen i").attr("class","fa fa-chevron-right"))):(t("#lnkToolOpen i").attr("class","fa fa-chevron-right"),t("#divSnippetScrollUp").css("left","10px"),t("#divSnippetScrollDown").css("left","10px"),t("#divTool").css("width",m+"px"),t("#divTool").css("left","-"+m+"px"),t("#lnkToolOpen").addClass("leftside"),t("#lnkToolOpen").unbind("click"),t("#lnkToolOpen").click(function(e){if(t(".toolbar-row").stop(!0,!0).fadeOut(0),t(".ui-draggable").removeClass("code"),t(".ui-draggable").removeClass("ui-dragbox-outlined"),t("#rte-toolbar").css("display","none"),cb_snippetPageSliding||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)){if(0==parseInt(t("#divTool").css("left")))t("#divTool").animate({left:"-="+(m+0)+"px"},200),t("body").animate({marginLeft:"-="+m+"px"},250),t("#rte-toolbar").animate({paddingLeft:"-="+m+"px"},250),t("#lnkToolOpen i").attr("class","fa fa-chevron-right"),t("#divSnippetScrollUp").fadeOut(300),t("#divSnippetScrollDown").fadeOut(300);else if(t("#divTool").animate({left:"+="+(m+0)+"px"},200),t("body").animate({marginLeft:"+="+m+"px"},250),t("#rte-toolbar").animate({paddingLeft:"+="+m+"px"},250),t("#lnkToolOpen i").attr("class","fa fa-chevron-left"),u){var i=t("#divSnippetList").height()/2-60;t("#divSnippetScrollUp").css("top",i),t("#divSnippetScrollDown").css("top",i+60),0!=t("#divSnippetList").scrollTop()?t("#divSnippetScrollUp").fadeIn(300):t("#divSnippetScrollUp").fadeOut(300),t("#divSnippetScrollDown").fadeIn(300)}t("#rte-toolbar").css("display","none")}else if(0==parseInt(t("#divTool").css("left")))t("#divTool").animate({left:"-="+(m+0)+"px"},200),t("#lnkToolOpen i").attr("class","fa fa-chevron-right"),t("#divSnippetScrollUp").css("display","none"),t("#divSnippetScrollDown").css("display","none");else if(t("#divTool").animate({left:"+="+(m+0)+"px"},200),t("#lnkToolOpen i").attr("class","fa fa-chevron-left"),u){var i=t("#divSnippetList").height()/2-60;t("#divSnippetScrollUp").css("top",i),t("#divSnippetScrollDown").css("top",i+60),0!=t("#divSnippetList").scrollTop()?t("#divSnippetScrollUp").fadeIn(300):t("#divSnippetScrollUp").fadeOut(300),t("#divSnippetScrollDown").fadeIn(300)}e.preventDefault()}),t(".toolbar-row").css("left","auto"),600>p?t(".toolbar-row").css("right","-30px"):t(".toolbar-row").css("right","-37px"),this.settings.snippetOpen&&1!=t("#divTool").attr("data-snip-open")&&(t("#divTool").attr("data-snip-open",1),t("#divTool").animate({left:"+="+m+"px"},900,"swing",this.settings.snippetOpenCallback),t("#lnkToolOpen i").attr("class","fa fa-chevron-left"))),this.applyBehavior(),this.blockChanged(),this.settings.onRender(),a.sortable({helper:function(e,i){return t("<div></div>").get(0)},sort:function(t,e){a.data("contentbuilder").settings.hideDragPreview&&e.helper.css({display:"none"})},items:".ui-draggable",connectWith:".connectSortable",handle:".row-handle",cursor:"move",placeholder:"block-placeholder",start:function(t,e){cb_edit=!1},change:function(t,e){},beforeStop:function(e,i){t(i.placeholder).hide()},deactivate:function(e,i){if(a.data("contentbuilder")){cb_edit=!0;var n=!1;0==i.item.find(".toolbar-row").length&&(n=!0),i.item.parent().attr("id")==a.attr("id")&&(i.item.replaceWith(i.item.html()),a.children("*").each(function(){t(this).hasClass("ui-draggable")||t(this).wrap("<div class='ui-draggable'></div>")}),a.children(".ui-draggable").each(function(){0==t(this).find(".toolbar-row").length&&t(this).append('<div class="toolbar-row toolbar"><div class="row-handle"><i class="fa fa-arrows"></i></div><div class="row-html"><i class="fa fa-code"></i></div><div class="row-copy"><i class="fa fa-plus-square-o"></i></div><div class="row-remove"><i class="fa fa-minus-square-o"></i></div></div>')}),a.children(".ui-draggable").each(function(){1==t(this).children("*").length&&t(this).remove(),2==t(this).children("*").length&&"img"==t(this).children(0).prop("tagName").toLowerCase()&&-1!=t(this).children(0).attr("src").indexOf("thumbnails/")&&t(this).remove()})),a.data("contentbuilder").applyBehavior(),a.data("contentbuilder").blockChanged(),a.data("contentbuilder").settings.onDrop(e,i)}}}),-1!=cb_list.indexOf(",")&&t(cb_list).sortable("option","axis",!1),""!=this.settings.axis&&t(cb_list).sortable("option","axis",this.settings.axis),t.ui.isOverAxis2=function(t,e,i){return t>=e&&e+i>t},t.ui.isOver=function(e,i,n,o,s,a){return t.ui.isOverAxis2(e,n,s)&&t.ui.isOverAxis(i,o,a)},a.droppable({drop:function(e,i){if(t(i.draggable).data("snip")){var n=t(i.draggable).data("snip"),o=t("#snip"+n).text();return t(i.draggable).data("snip",null),i.draggable.html(o)}},tolerance:"touch",greedy:!0,hoverClass:"drop-zone",activeClass:"drop-zone",deactivate:function(e,i){t(cb_list).each(function(){var e=t(this);e.children(".ui-draggable").each(function(){0==t(this).find(".toolbar-row").length&&t(this).append('<div class="toolbar-row toolbar"><div class="row-handle"><i class="fa fa-arrows"></i></div><div class="row-html"><i class="fa fa-code"></i></div><div class="row-copy"><i class="fa fa-plus-square-o"></i></div><div class="row-remove"><i class="fa fa-minus-square-o"></i></div></div>')}),e.data("contentbuilder").applyBehavior()})}}),t(document).bind("mousedown",function(e){var i;if(t(e.target).parents(".ui-draggable").length>0&&t(e.target).parents(".ui-draggable").parent().data("contentbuilder")&&(i=t(e.target).parents(".ui-draggable").parent()),"ovl"==t(e.target).attr("class")&&t(e.target).css("z-index","-1"),t(e.target).parents(".ui-draggable").length>0&&t(e.target).parents(cb_list).length>0){var n=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;return t(".ui-draggable").removeClass("code"),t(e.target).parents("[data-mode='code']").length>0&&t(e.target).parents(".ui-draggable").addClass("code"),t(e.target).parents("[data-mode='readonly']").length>0&&t(e.target).parents(".ui-draggable").addClass("code"),t(".ui-draggable").removeClass("ui-dragbox-outlined"),t(e.target).parents(".ui-draggable").addClass("ui-dragbox-outlined"),n&&t(e.target).parents(".ui-draggable").addClass("firefox"),t(".toolbar-row").stop(!0,!0).fadeOut(0),i&&(t(e.target).parents(".ui-draggable").find("[data-html-edit='off']").length>0||!i.data("contentbuilder").settings.sourceEditor)&&t(e.target).parents(".ui-draggable").find(".toolbar-row .row-html").css({display:"none"}),void t(e.target).parents(".ui-draggable").find(".toolbar-row").stop(!0,!0).css({display:"none"}).fadeIn(300)}"rte-toolbar"!=t(e.target).parent().attr("id")&&"rte-toolbar"!=t(e.target).parent().parent().attr("id")&&(t(e.target).is("[contenteditable]")||"absolute"==t(e.target).css("position")||"fixed"==t(e.target).css("position")||(t(e.target).parents().each(function(e){t(this).is("[contenteditable]")||"absolute"==t(this).css("position")||"fixed"==t(this).css("position")}),t(".toolbar-row").stop(!0,!0).fadeOut(0),t(".ui-draggable").removeClass("code"),t(".ui-draggable").removeClass("ui-dragbox-outlined"),t("#rte-toolbar").css("display","none")))})},this.applyDraggable=function(e){var i=!1;"1.11.0"==t.ui.version&&(i=!0),i?t(cb_snippetList+" > div").not(".locked").draggable({cursor:"move",helper:function(){return t("<div class='dynamic'></div>")[0]},delay:200,connectToSortable:cb_list,stop:function(e,i){t(cb_list).each(function(){var e=t(this);e.children("div").each(function(){1==t(this).children("img").length&&t(this).remove()})})}}):t(cb_snippetList+" > div").not(".locked").draggable({cursor:"move",helper:"clone",drag:function(e,i){1!=a.data("contentbuilder").settings.zoom&&(t(i.helper).css("position","absolute"),i.helper.parent().is("body")||i.helper.appendTo(t("body")))},connectToSortable:cb_list,stop:function(e,i){t(cb_list).each(function(){var e=t(this);e.children("div").each(function(){1==t(this).children("img").length&&t(this).remove()})})}})},this.html=function(){this.settings.selectable;t("#temp-contentbuilder").html(a.html()),t("#temp-contentbuilder").find(".toolbar-row").remove(),t("#temp-contentbuilder").find(".ovl").remove(),t("#temp-contentbuilder").find("[contenteditable]").removeAttr("contenteditable"),t('*[class=""]').removeAttr("class"),t("#temp-contentbuilder").find(".ui-draggable").replaceWith(function(){return t(this).html()}),t("#temp-contentbuilder").find("[data-mode='code']").each(function(){void 0!=t(this).attr("data-html")&&t(this).html(decodeURIComponent(t(this).attr("data-html")))});var e=t("#temp-contentbuilder").html().trim();return e=e.replace(/<font/g,"<span").replace(/<\/font/g,"</span")},this.zoom=function(e){this.settings.zoom=e,t(cb_list).css("zoom",e),t(cb_list).css("-moz-transform","scale("+e+")"),localStorage.zoom=e,t(".toolbar-row").stop(!0,!0).fadeOut(0),t(".ui-draggable").removeClass("code"),t(".ui-draggable").removeClass("ui-dragbox-outlined"),t("#rte-toolbar").css("display","none")},this.clearControls=function(){t(".toolbar-row").stop(!0,!0).fadeOut(0),t(".ui-draggable").removeClass("code"),t(".ui-draggable").removeClass("ui-dragbox-outlined");var e=this.settings.selectable;a.find(e).blur()},this.viewHtml=function(){t("#md-html").css("width","45%"),hideAllSimpleModals(),t("#md-html").simplemodal(),t("#md-html").data("simplemodal").show(),t("#txtHtml").val(this.html()),t("#btnHtmlOk").unbind("click"),t("#btnHtmlOk").bind("click",function(e){a.html(t("#txtHtml").val()),t("#md-html").data("simplemodal").hide(),a.children("*").wrap("<div class='ui-draggable'></div>"),a.children("*").append('<div class="toolbar-row toolbar"><div class="row-handle"><i class="fa fa-arrows"></i></div><div class="row-html"><i class="fa fa-code"></i></div><div class="row-copy"><i class="fa fa-plus-square-o"></i></div><div class="row-remove"><i class="fa fa-minus-square-o"></i></div></div>'),a.data("contentbuilder").applyBehavior(),a.data("contentbuilder").blockChanged(),a.data("contenteditor").changeCallback()})},this.loadHTML=function(t){a.html(t),a.children("*").wrap("<div class='ui-draggable'></div>"),a.children("*").append('<div class="toolbar-row toolbar"><div class="row-handle"><i class="fa fa-arrows"></i></div><div class="row-html"><i class="fa fa-code"></i></div><div class="row-copy"><i class="fa fa-plus-square-o"></i></div><div class="row-remove"><i class="fa fa-minus-square-o"></i></div></div>'),a.data("contentbuilder").applyBehavior(),a.data("contentbuilder").blockChanged(),a.data("contenteditor").onChanged()},this.applyBehavior=function(){a.find("a").click(function(){return!1}),a.find("[data-mode='code']").each(function(){void 0!=t(this).attr("data-html")&&t(this).html(decodeURIComponent(t(this).attr("data-html")))});var e=this.settings.selectable,n=this.settings.hiquality,o=this.settings.imageEmbed,s=this.settings.colors,r=this.settings.editMode,l=this.settings.toolbar,d=this.settings.toolbarDisplay,c=this.settings.onImageSelectClick,h=this.settings.onFileSelectClick,p=this.settings.onImageBrowseClick,m=this.settings.onImageSettingClick,u=this.settings.imageselect,f=this.settings.fileselect,g=this.settings.iconSelect,v=this.settings.customval,b=this.settings.largerImageHandler,w=this.settings.changeCallback;a.contenteditor({fileselect:f,iconSelect:g,editable:e,colors:s,editMode:r,toolbar:l,toolbarDisplay:d,onFileSelectClick:h,changeCallback:w}),a.data("contenteditor").render(),a.find("img").each(function(){var e=function(e){t(e).imageembed({hiquality:n,imageselect:u,fileselect:f,imageEmbed:o,onImageBrowseClick:p,onImageSettingClick:m,onImageSelectClick:c,onFileSelectClick:h,largerImageHandler:b,customval:v})};t(this).parents("[data-mode='code']").length>0||t(this).parents("[data-mode='readonly']").length>0||(e(this),0!=t(this).parents("figure").length&&"absolute"==t(this).parents("figure").find("figcaption").css("position")&&e(t(this).parents("figure")))}),a.find(".embed-responsive").each(function(){t(this).parents("[data-mode='code']").length>0||t(this).parents("[data-mode='readonly']").length>0||0==t(this).find(".ovl").length&&t(this).append('<div class="ovl" style="position:absolute;background:#fff;opacity:0.2;cursor:pointer;top:0;left:0px;width:100%;height:100%;z-index:-1"></div>')}),a.find(".embed-responsive").hover(function(){t(this).parents("[data-mode='code']").length>0||t(this).parents("[data-mode='readonly']").length>0||"none"==t(this).parents(".ui-draggable").css("outline-style")&&t(this).find(".ovl").css("z-index","1")},function(){t(this).find(".ovl").css("z-index","-1")}),a.find(e).unbind("focus"),a.find(e).focus(function(){var e=(a.data("contentbuilder").settings.zoom,a.data("contentbuilder").settings.selectable,navigator.userAgent.toLowerCase().indexOf("firefox")>-1);t(".ui-draggable").removeClass("code"),t(this).parents("[data-mode='code']").length>0&&t(this).parents(".ui-draggable").addClass("code"),t(this).parents("[data-mode='readonly']").length>0&&t(this).parents(".ui-draggable").addClass("code"),t(".ui-draggable").removeClass("ui-dragbox-outlined"),t(this).parents(".ui-draggable").addClass("ui-dragbox-outlined"),e&&t(this).parents(".ui-draggable").addClass("firefox"),t(".toolbar-row").stop(!0,!0).fadeOut(0),(t(this).parents(".ui-draggable").find("[data-html-edit='off']").length>0||!a.data("contentbuilder").settings.sourceEditor)&&t(this).parents(".ui-draggable").find(".toolbar-row .row-html").css({display:"none"}),t(this).parents(".ui-draggable").find(".toolbar-row").stop(!0,!0).css({display:"none"}).fadeIn(300)}),a.children("div").find(".row-remove").unbind(),a.children("div").find(".row-remove").click(function(){t("#md-delrowconfirm").css("max-width","550px"),hideAllSimpleModals(),t("#md-delrowconfirm").simplemodal(),t("#md-delrowconfirm").data("simplemodal").show(),i=t(this).parents(".ui-draggable"),t("#btnDelRowOk").unbind("click"),t("#btnDelRowOk").bind("click",function(e){t("#md-delrowconfirm").data("simplemodal").hide(),i.fadeOut(400,function(){t("#toolbar-img-upload").stop(!0,!0).fadeOut(0),t("#toolbar-img-settings").stop(!0,!0).fadeOut(0),t("#toolbar-link").stop(!0,!0).fadeOut(0),t("#toolbar-frame").stop(!0,!0).fadeOut(0),i.remove(),a.data("contentbuilder").blockChanged(),a.data("contenteditor").onChanged()})}),t("#btnDelRowCancel").unbind("click"),t("#btnDelRowCancel").bind("click",function(e){t("#md-delrowconfirm").data("simplemodal").hide()})}),a.children("div").find(".row-copy").unbind(),a.children("div").find(".row-copy").click(function(){i=t(this).parents(".ui-draggable"),t("#temp-contentbuilder").html(i.html()),t("#temp-contentbuilder").find("[contenteditable]").removeAttr("contenteditable"),t('#temp-contentbuilder *[class=""]').removeAttr("class"),t('#temp-contentbuilder *[style=""]').removeAttr("style"),t("#temp-contentbuilder .ovl").remove(),t("#temp-contentbuilder .toolbar-row").remove();var e=t("#temp-contentbuilder").html().trim();i.after(e),a.children("*").each(function(){t(this).hasClass("ui-draggable")||t(this).wrap("<div class='ui-draggable'></div>")}),a.children(".ui-draggable").each(function(){0==t(this).find(".toolbar-row").length&&t(this).append('<div class="toolbar-row toolbar"><div class="row-handle"><i class="fa fa-arrows"></i></div><div class="row-html"><i class="fa fa-code"></i></div><div class="row-copy"><i class="fa fa-plus-square-o"></i></div><div class="row-remove"><i class="fa fa-minus-square-o"></i></div></div>')}),a.children(".ui-draggable").each(function(){1==t(this).children("*").length&&t(this).remove()}),a.data("contentbuilder").applyBehavior(),a.data("contentbuilder").blockChanged(),a.data("contenteditor").onChanged()}),a.children("div").find(".row-html").unbind(),a.children("div").find(".row-html").click(function(){if(t("#md-html").css("width","45%"),hideAllSimpleModals(),t("#md-html").simplemodal(),t("#md-html").data("simplemodal").show(),i=t(this).parents(".ui-draggable").children("*").not(".toolbar-row"),"code"==i.data("mode")&&void 0!=i.attr("data-html"))t("#txtHtml").val(decodeURIComponent(i.attr("data-html")));else{t("#temp-contentbuilder").html(i.html()),t("#temp-contentbuilder").find("[contenteditable]").removeAttr("contenteditable"),t('#temp-contentbuilder *[class=""]').removeAttr("class"),t('#temp-contentbuilder *[style=""]').removeAttr("style"),t("#temp-contentbuilder .ovl").remove();var e=t("#temp-contentbuilder").html().trim();e=e.replace(/<font/g,"<span").replace(/<\/font/g,"</span"),t("#txtHtml").val(e)}t("#btnHtmlOk").unbind("click"),t("#btnHtmlOk").bind("click",function(e){"code"==i.data("mode")?(i.attr("data-html",encodeURIComponent(t("#txtHtml").val())),i.html("")):i.html(t("#txtHtml").val()),t("#md-html").data("simplemodal").hide(),a.data("contentbuilder").applyBehavior(),a.data("contentbuilder").blockChanged(),a.data("contenteditor").onChanged()})}),t(".toolbar-row-item").remove(),a.find("[class*=item]").parent(".row").tooltip({title:'<div class="row-item-copy"><i class="fa fa-plus-square-o"></i></div><div class="row-item-remove"><i class="fa fa-minus-square-o"></i></div>',html:!0,trigger:"focus",placement:"bottom",container:"body",template:'<div class="tooltip toolbar-row-item toolbar" role="tooltip"><div class="tooltip-inner"></div></div>'}).unbind("shown.bs.tooltip").bind("shown.bs.tooltip",function(){var e=t(this).data("bs.tooltip").$tip,i=t(this);e.find(".row-item-remove").click(function(){t("#md-delrowconfirm").css("max-width","550px"),hideAllSimpleModals(),t("#md-delrowconfirm").simplemodal(),t("#md-delrowconfirm").data("simplemodal").show(),t("#btnDelRowOk").unbind("click"),t("#btnDelRowOk").bind("click",function(e){t("#md-delrowconfirm").data("simplemodal").hide(),i.fadeOut(400,function(){t("#toolbar-img-upload").stop(!0,!0).fadeOut(0),t("#toolbar-img-settings").stop(!0,!0).fadeOut(0),t("#toolbar-link").stop(!0,!0).fadeOut(0),t("#toolbar-frame").stop(!0,!0).fadeOut(0),i.remove()}),a.data("contentbuilder").applyBehavior(),a.data("contentbuilder").blockChanged(),a.data("contenteditor").onChanged()}),t("#btnDelRowCancel").unbind("click"),t("#btnDelRowCancel").bind("click",function(e){t("#md-delrowconfirm").data("simplemodal").hide()})}),e.find(".row-item-copy").click(function(){$clone=i.clone(),i.after($clone.hide().fadeIn(400)),a.data("contentbuilder").applyBehavior(),a.data("contentbuilder").blockChanged(),a.data("contenteditor").onChanged()})})},this.blockChanged=function(){0==a.children().length?a.addClass("empty"):a.removeClass("empty"),a.data("contenteditor").onChanged&&a.data("contenteditor").onChanged()},this.destroy=function(){if(a.data("contentbuilder")){var e=a.data("contentbuilder").html();a.html(e),a.sortable("destroy");for(var i=cb_list.split(","),n=[],o=0;o<i.length;o++)i[o]!="#"+a.attr("id")&&n.push(i[o]);cb_list=n.join(","),a.removeClass("connectSortable"),a.css({"min-height":""}),""==cb_list&&(t("#divCb").remove(),t(document).unbind("mousedown")),a.removeData("contentbuilder"),a.removeData("contenteditor"),a.unbind()}},this.init()},t.fn.contentbuilder=function(e){return this.each(function(){if(void 0==t(this).data("contentbuilder")){var i=new t.contentbuilder(this,e);t(this).data("contentbuilder",i)}})}}(jQuery);var ce_toolbarDisplay="auto",ce_outline=!1;!function(t){var e,i,n,o=[];t.fn.count=function(){},t.contenteditor=function(s,a){function r(){iconSelect=d.data("contenteditor").settings.iconSelect,t("#ifrIconSelect").attr("src")!=iconSelect?(t("#ifrIconSelect").attr("src",iconSelect),t("#ifrIconSelect").on("load",function(){this.contentWindow.init()})):t("#ifrIconSelect")[0].contentWindow.init()}var l={editable:"h1,h2,h3,h4,h5,h6,p,ul,ol,small,.edit",editMode:"default",hasChanged:!1,onRender:function(){},changeCallback:function(){},outline:!1,fileselect:"",iconSelect:"",onFileSelectClick:function(){},toolbar:"top",toolbarDisplay:"auto",colors:["#ffffc5","#e9d4a7","#ffd5d5","#ffd4df","#c5efff","#b4fdff","#c6f5c6","#fcd1fe","#ececec","#f7e97a","#d09f5e","#ff8d8d","#ff80aa","#63d3ff","#7eeaed","#94dd95","#ef97f3","#d4d4d4","#fed229","#cc7f18","#ff0e0e","#fa4273","#00b8ff","#0edce2","#35d037","#d24fd7","#888888","#ff9c26","#955705","#c31313","#f51f58","#1b83df","#0bbfc5","#1aa71b","#ae19b4","#333333"]};this.settings={};var d=t(s),s=s;this.init=function(){var e=this;this.settings=t.extend({},l,a);var n=!1;""!=this.settings.fileselect&&(n=!0);var s=(this.settings.onFileSelectClick+"").replace(/\s/g,"");"function(){}"!=s&&(n=!0),0==t("#divCb").length&&t("body").append('<div id="divCb"></div>'),ce_toolbarDisplay=this.settings.toolbarDisplay,ce_outline=this.settings.outline;for(var r='<div id="toolbar-link" class="toolbar"><span class="edit-link"><i class="fa fa-link"></i> Edit Link</span><span class="divider"> | </span><span class="edit-link-icon"><i class="fa fa-smile-o"></i> Edit Icon</span></div><div id="toolbar-frame" class="toolbar"><i class="fa fa-link"></i> Edit Link</div><div class="md-modal" id="md-createlink"><div class="md-content"><div class="md-body"><div class="md-label">Link:</div>'+(n?'<input type="text" id="txtLink" class="inptxt" placeholder="URL or email address" style="float:left;width:50%;"></input><i class="fa fa-link md-btnbrowse" id="btnLinkBrowse" style="width:10%;"></i>':'<input type="text" id="txtLink" class="inptxt" placeholder="URL or email address" style="float:left;width:60%"></input>')+'<br style="clear:both"><div class="md-label">Text:</div><input type="text" id="txtLinkText" class="inptxt" style="float:right;width:60%"></input><br style="clear:both"></div><div class="md-footer"><button id="btnLinkOk"> Ok </button></div></div></div><div class="md-modal" id="md-createsrc"><div class="md-content"><div class="md-body"><input type="text" id="videoSrc" class="inptxt" placeholder="YouTube, Vimeo, or Google Drive video URL"></input></div><div class="md-footer"><button id="btnSrcOk"> Ok </button></div></div></div><div class="md-modal" id="md-align" style="background:#fff;border-radius:12px"><div class="md-content"><div class="md-body"><div style="padding:15px 0 15px 15px;"><button class="md-pickalign" data-align="left" title="Left"> <i class="fa fa-align-left"></i> <span>Left</span> </button><button class="md-pickalign" data-align="center" title="Center"> <i class="fa fa-align-center"></i> <span>Center</span> </button><button class="md-pickalign" data-align="right" title="Right"> <i class="fa fa-align-right"></i> <span>Right</span> </button><button class="md-pickalign" data-align="justify" title="Full"> <i class="fa fa-align-justify"></i> <span>Full</span> </button></div></div></div></div><div class="md-modal" id="md-list" style="background:#fff;border-radius:12px"><div class="md-content"><div class="md-body"><div style="padding:15px 0 15px 15px;"><button class="md-picklist half" data-list="indent" title="Indent" style="margin-right:0px"> <i class="fa fa-indent"></i> </button><button class="md-picklist half" data-list="outdent" title="Outdent"> <i class="fa fa-dedent"></i> </button><button class="md-picklist" data-list="insertUnorderedList" title="Bulleted List"> <i class="fa fa-list-ul"></i> <span>Bulleted</span> </button><button class="md-picklist" data-list="insertOrderedList" title="Numbered List"> <i class="fa fa-list-ol"></i> <span>Numbered</span> </button><button class="md-picklist" data-list="normal" title="Remove List"> <i class="fa fa-minus-square-o"></i> <span>Remove</span> </button></div></div></div></div><div class="md-modal" id="md-fonts" style="border-radius:12px"><div class="md-content" style="border-radius:12px"><div class="md-body"><iframe id="ifrFonts" style="width:100%;height:371px;border: none;display: block;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJCAYAAADgkQYQAAAAFElEQVQYV2P8DwQMBADjqCKiggAAmZsj5vuXmnUAAAAASUVORK5CYII="></iframe><button class="md-pickfontfamily" data-font-family="" data-provider="" style="display:none"></button></div></div></div><div class="md-modal" id="md-fontsize" style="border-radius:12px"><div class="md-content" style="border-radius:12px"><div class="md-body"><iframe id="ifrFontSize" style="width:100%;height:319px;border: none;display: block;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJCAYAAADgkQYQAAAAFElEQVQYV2P8DwQMBADjqCKiggAAmZsj5vuXmnUAAAAASUVORK5CYII="></iframe><button class="md-pickfontsize" data-font-size="" style="display:none"></button></div></div></div><div class="md-modal" id="md-headings" style="border-radius:12px"><div class="md-content" style="border-radius:12px"><div class="md-body"><iframe id="ifrHeadings" style="width:100%;height:335px;border: none;display: block;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJCAYAAADgkQYQAAAAFElEQVQYV2P8DwQMBADjqCKiggAAmZsj5vuXmnUAAAAASUVORK5CYII="></iframe><button class="md-pickheading" data-heading="" style="display:none"></button></div></div></div><div class="md-modal" id="md-color" style="background:#fff;border-radius:12px"><div class="md-content"><div class="md-body"><div style="padding:15px 0px 15px 15px;"><div style="width:100%"><select id="selColorApplyTo" style="width:85%"><option value="1">Text Color</option><option value="2">Background</option><option value="3">Block Background</option></select><button id="btnCleanColor" style="cursor: pointer;border: none;margin: 0 0 0 10px;vertical-align: middle;padding-4px;border-radius:5px;"><i class="fa fa-eraser" style="font-size:25px"></i></button></div>[COLORS]<br style="clear:both" /></div></div></div></div><div class="md-modal" id="md-html"><div class="md-content"><div class="md-body"><textarea id="txtHtml" class="inptxt" style="height:350px;"></textarea></div><div class="md-footer"><button id="btnHtmlOk"> Ok </button></div></div></div><div class="md-modal" id="md-fileselect"><div class="md-content"><div class="md-body">'+(n?'<iframe id="ifrFileBrowse" style="width:100%;height:400px;border: none;display: block;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJCAYAAADgkQYQAAAAFElEQVQYV2P8DwQMBADjqCKiggAAmZsj5vuXmnUAAAAASUVORK5CYII="></iframe>':"")+'</div></div></div><input type="hidden" id="active-input" /><div class="md-modal" id="md-delrowconfirm"><div class="md-content"><div class="md-body"><div style="padding:20px 20px 25px;text-align:center;"><p>Are you sure you want to delete this block?</p><button id="btnDelRowCancel"> CANCEL </button><button id="btnDelRowOk" style="margin-left:12px"> OK </button></div></div></div></div><div class="md-modal md-draggable" id="md-icon-select"><div class="md-content"><div class="md-body md-settings"><div class="md-modal-handle"><div style="margin:0;font-size:15px;line-height:22px;text-align:center;"><i class="fa fa-ellipsis-h"></i></div></div><iframe id="ifrIconSelect" style="width:100%;height:500px;hidden;border:none;float:left;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJCAYAAADgkQYQAAAAFElEQVQYV2P8DwQMBADjqCKiggAAmZsj5vuXmnUAAAAASUVORK5CYII="></iframe></div></div></div><div id="temp-contenteditor"></div>',c="",h=0;h<this.settings.colors.length;h++)c+="#ececec"==this.settings.colors[h]?'<button class="md-pick" style="background:'+this.settings.colors[h]+';border:#e7e7e7 1px solid"></button>':'<button class="md-pick" style="background:'+this.settings.colors[h]+";border:"+this.settings.colors[h]+' 1px solid"></button>';
r=r.replace("[COLORS]",c),t("#divCb").append(r),this.prepareRteCommand("bold"),this.prepareRteCommand("italic"),this.prepareRteCommand("underline"),this.prepareRteCommand("strikethrough"),setTimeout(function(){e.setUpUndoRedo(d)});var p=!1;d.bind("keyup",function(t){d.data("contenteditor").realtime()}),d.bind("mouseup",function(t){d.data("contenteditor").realtime()}),t(document).on("paste","#"+d.attr("id"),function(t){t.preventDefault();var e="",i=$(this);t.clipboardData?e=t.clipboardData.getData("text/plain"):window.clipboardData?e=window.clipboardData.getData("Text"):t.originalEvent.clipboardData&&(e=$("<div></div>").text(t.originalEvent.clipboardData.getData("text"))),document.queryCommandSupported("insertText")?document.execCommand("insertHTML",!1,$(e).html()):(i.find("*").each(function(){$(this).addClass("within")}),setTimeout(function(){i.find("*").each(function(){$(this).not(".within").contents().unwrap()})},1)),d.data("contenteditor").onChanged()}),d.bind("keydown",function(e){if(46==e.which||8==e.which){var i;try{if(window.getSelection?i=window.getSelection().getRangeAt(0).commonAncestorContainer.parentNode:document.selection&&(i=document.selection.createRange().parentElement()),"p"==i.nodeName.toLowerCase()){var n="";if(window.getSelection?n=window.getSelection().toString():document.getSelection?n=document.getSelection().toString():document.selection&&(n=document.selection.createRange().text),n==i.innerText)return t(i).html("<br>"),!1}}catch(e){}}if(17==e.which)return void(p=!0);if(32==e.which&&!p){var i,o=detectIE();try{window.getSelection?i=window.getSelection().getRangeAt(0).commonAncestorContainer.parentNode:document.selection&&(i=document.selection.createRange().parentElement())}catch(e){return}if(t(i).is("i.fa")){e.preventDefault();var s,a=t(i).parent("a")[0]||i,r=document.createTextNode("\xa0");t(a).after(r),selectEndOfNodeContents(r)}}if(e.ctrlKey&&(65==e.keyCode||97==e.keyCode)){e.preventDefault();var i,o=detectIE();try{window.getSelection?i=window.getSelection().getRangeAt(0).commonAncestorContainer.parentNode:document.selection&&(i=document.selection.createRange().parentElement())}catch(e){return}if(o){var s=document.body.createTextRange();s.moveToElementText(i),s.select()}else{var s=document.createRange();s.selectNodeContents(i);var l=window.getSelection();l.removeAllRanges(),l.addRange(s)}}}).keyup(function(t){17==t.which&&(p=!1)}),t(document).on("mousedown",function(e){var n;t(e.target).parents(".ui-draggable").length>0&&t(e.target).parents(".ui-draggable").parent().data("contentbuilder")&&(n=t(e.target).parents(".ui-draggable").parent());var s=!1;if("none"!=t("#rte-toolbar").css("display")){var a=t(e.target).prop("tagName").toLowerCase();if(t(e.target).parents().each(function(e){return t(this).is("[contenteditable]")||t(this).hasClass("md-modal")||"divCb"==t(this).attr("id")||"rte-toolbar"==t(this).attr("id")?void(s=!0):void 0}),t(e.target).is("[contenteditable]"))return void(s=!0);if(!s){if(i=null,"auto"==ce_toolbarDisplay){var a;window.getSelection?a=window.getSelection().getRangeAt(0).commonAncestorContainer.parentNode:document.selection&&(a=document.selection.createRange().parentElement());var r=!1;t(a).parents().each(function(){t(this).data("contentbuilder")&&(r=!0)}),r||t("#rte-toolbar").css("display","none")}if(ce_outline)for(var l=0;l<o.length;l++)t(o[l]).css("outline",""),t(o[l]).find("*").css("outline","");t(".toolbar-row").stop(!0,!0).fadeOut(0),t(".ui-draggable").removeClass("code"),t(".ui-draggable").removeClass("ui-dragbox-outlined"),t("#rte-toolbar").css("display","none")}}})},this.onChanged=null,this.setUpUndoRedo=function(t){var e,i,n,o,s,a,r,l,d;e=this,i=new Undo.Stack,s=$(".btn-undo"),a=$(".btn-redo"),o=Undo.Command.extend({constructor:function(t,e,i){this.textarea=t,this.oldValue=e,this.newValue=i},execute:function(){},undo:function(){this.textarea.html(this.oldValue)},redo:function(){this.textarea.html(this.newValue)}}),n=function(){s.attr("disabled",!i.canUndo()),a.attr("disabled",!i.canRedo())},i.changed=function(){n()},n(),$("#rte-toolbar").delegate(".btn-undo, .btn-redo","click",function(){var t;return t=$(this).attr("data-rte-cmd"),i[t](),!1}),r=t.html(),this.executeUndoableCommand=function(){var n;n=t.html(),n!==r&&(i.execute(new o(t,r,n)),r=n,e.hasChanged=!0)},this.onChanged=function(){clearTimeout(d),d=setTimeout(e.executeUndoableCommand,250),t.data("contenteditor").settings.changeCallback()},t.keypress(function(t){e.onChanged()}),t.keydown(function(e){var n,o;e.metaKey&&90===e.keyCode&&(e.preventDefault(),n=t.text().length,l=saveAbsoluteSelection(t[0]),e.shiftKey?i.canRedo()&&i.redo():i.canUndo()&&i.undo(),t.data("contentbuilder").applyBehavior(),o=t.text().length-n,l.start+=o,l.end+=o,l.start<0&&(l.start=0,l.end=0),restoreAbsoluteSelection(t[0],l))})},this.applyIconBehavior=function(){var e=this,i=this.settings.iconSelect;""!=i&&d.find(".ui-draggable > div:first-child i.fa").each(function(){t(this).unbind("click"),t(this).click(function(){$activeIcon=t(this),e.openIconSelectModal()})})},this.openIconSelectModal=function(){t("#md-icon-select").css("max-width","775px"),hideAllSimpleModals(),t("#md-icon-select").simplemodal(),t("#md-icon-select").data("simplemodal").show(),r()},this.realtime=function(){var e;detectIE();try{window.getSelection?e=window.getSelection().getRangeAt(0).commonAncestorContainer.parentNode:document.selection&&(e=document.selection.createRange().parentElement())}catch(n){return}if(!(t(e).parents("[data-mode='code']").length>0||t(e).parents("[data-mode='readonly']").length>0)){"a"==e.nodeName.toLowerCase()?t("#toolbar-link").addClass("forceshow"):t("#toolbar-link").removeClass("forceshow");var s=d.data("contenteditor").settings.editable;""==s||(d.find(s).unbind("mousedown"),d.find(s).bind("mousedown",function(e){if(i=t(this),t("#rte-toolbar").stop(!0,!0).fadeIn(200),ce_outline){for(var n=0;n<o.length;n++)t(o[n]).css("outline",""),t(o[n]).find("*").css("outline","");t(this).css("outline","rgba(0, 0, 0, 0.43) dashed 1px")}}),d.find(".edit").find(s).removeAttr("contenteditable"))}},this.render=function(){var s;s=null!=localStorage.getItem("zoom")?localStorage.zoom:d.css("zoom"),void 0==s&&(s=1),localStorage.zoom=s;var a=d.data("contenteditor").settings.editable;""==a?(d.attr("contenteditable","true"),d.unbind("mousedown"),d.bind("mousedown",function(e){if(i=t(this),t("#rte-toolbar").stop(!0,!0).fadeIn(200),ce_outline){for(var n=0;n<o.length;n++)t(o[n]).css("outline",""),t(o[n]).find("*").css("outline","");t(this).css("outline","rgba(0, 0, 0, 0.43) dashed 1px")}})):(d.find(a).each(function(){if(!(t(this).parents("[data-mode='code']").length>0||t(this).parents("[data-mode='readonly']").length>0)){var e=d.data("contenteditor").settings.editMode;if("default"==e);else{var i=t(this).attr("contenteditable");"undefined"!=typeof i&&i!==!1||t(this).attr("contenteditable","true")}}}),d.find(a).unbind("mousedown"),d.find(a).bind("mousedown",function(e){if(i=t(this),t("#rte-toolbar").stop(!0,!0).fadeIn(200),ce_outline){for(var n=0;n<o.length;n++)t(o[n]).css("outline",""),t(o[n]).find("*").css("outline","");t(this).css("outline","rgba(0, 0, 0, 0.43) dashed 1px")}}),d.find(".edit").find(a).removeAttr("contenteditable")),d.find("a").each(function(){t(this).parents("[data-mode='code']").length>0||t(this).parents("[data-mode='readonly']").length>0||t(this).attr("contenteditable","true")});var r=d.data("contenteditor").settings.editMode;"default"==r?(d.find("h1,h2,h3,h4,h5,h6").unbind("keydown"),d.find("h1,h2,h3,h4,h5,h6").bind("keydown",function(t){if(13==t.keyCode){var e=detectIE();if(!(e&&10>=e)){var i=window.getSelection(),n=i.getRangeAt(0);n.extractContents(),n.collapse(!0);var o=n.createContextualFragment("<br>"),s=o.lastChild;n.insertNode(o),n.setStartAfter(s),n.setEndAfter(s),1==n.endContainer.nodeType&&n.endOffset==n.endContainer.childNodes.length-1&&(n.insertNode(n.createContextualFragment("<br />")),n.setStartAfter(s),n.setEndAfter(s));var a=n.commonAncestorContainer;if(a&&a.parentNode)try{a.parentNode.normalize()}catch(t){}return i.removeAllRanges(),i.addRange(n),!1}var i=document.selection.createRange();if(i.parentElement)return i.pasteHTML("<br>"),t.cancelBubble=!0,t.returnValue=!1,i.select(),i.moveEnd("character",1),i.moveStart("character",1),i.collapse(!1),!1}}),d.find("h1,h2,h3,h4,h5,h6,p,img").each(function(){t(this).parents("[data-mode='code']").length>0||t(this).parents("[data-mode='readonly']").length>0||t(this).parent().attr("contenteditable",!0)}),d.find(".column").each(function(){t(this).parents("[data-mode='code']").length>0||t(this).parents("[data-mode='readonly']").length>0||t(this).attr("contenteditable",!0)}),d.find("div").unbind("keydown"),d.find("div").bind("keydown",function(e){var i,n;if(window.getSelection?(n=window.getSelection().getRangeAt(0).commonAncestorContainer,i=window.getSelection().getRangeAt(0).commonAncestorContainer.parentNode):document.selection&&(n=document.selection.createRange(),i=document.selection.createRange().parentElement()),(8==e.keyCode||46==e.keyCode)&&t(n)){var o=(t(n).prop("tagName")||"").toLowerCase();if(("h1"==o||"h1"==o||"h2"==o||"h3"==o||"h4"==o||"h5"==o||"h6"==o||"p"==o)&&""==t(n).text()){document.execCommand("removeFormat",!1,null),t(n).remove();var s=window.getSelection(),a=s.getRangeAt(0);a.extractContents(),a.collapse(!0),s.removeAllRanges(),s.addRange(a),e.preventDefault(),e.stopImmediatePropagation()}}})):(d.find("p").unbind("keydown"),d.find("p").bind("keydown",function(t){if(13==t.keyCode&&0==d.find("li").length){var e=navigator.userAgent.toLowerCase(),i=e.indexOf("msie")>=0?!0:!1;if(!i){var n=window.getSelection(),o=n.getRangeAt(0);o.extractContents(),o.collapse(!0);var s=o.createContextualFragment("<br>"),a=s.lastChild;o.insertNode(s),o.setStartAfter(a),o.setEndAfter(a),1==o.endContainer.nodeType&&o.endOffset==o.endContainer.childNodes.length-1&&(o.insertNode(o.createContextualFragment("<br />")),o.setStartAfter(a),o.setEndAfter(a));var r=o.commonAncestorContainer;if(r&&r.parentNode)try{r.parentNode.normalize()}catch(t){}return n.removeAllRanges(),n.addRange(o),!1}var n=document.selection.createRange();if(n.parentElement)return n.pasteHTML("<br>"),t.cancelBubble=!0,t.returnValue=!1,n.select(),n.moveEnd("character",1),n.moveStart("character",1),n.collapse(!1),!1}})),t('#rte-toolbar .btn[data-rte-cmd="removeElement"]').unbind("click"),t('#rte-toolbar .btn[data-rte-cmd="removeElement"]').click(function(t){i.remove(),d.data("contenteditor").render(),t.preventDefault()}),t('#rte-toolbar .btn[data-rte-cmd="color"]').unbind("click"),t('#rte-toolbar .btn[data-rte-cmd="color"]').click(function(e){var n=saveSelection();t("#md-color").css("max-width","485px"),hideAllSimpleModals(),t("#md-color").simplemodal(),t("#md-color").data("simplemodal").show(),e.preventDefault();var o=getSelected();t(".md-pick").unbind("click"),t(".md-pick").click(function(){restoreSelection(n);var s,a;window.getSelection?(a=window.getSelection().getRangeAt(0).commonAncestorContainer,s=window.getSelection().getRangeAt(0).commonAncestorContainer.parentNode):document.selection&&(a=document.selection.createRange(),s=document.selection.createRange().parentElement());var r=t("#selColorApplyTo").val();if(""!=t.trim(o)&&t(a).text()!=o){1==r&&document.execCommand("ForeColor",!1,t(this).css("background-color")),2==r&&document.execCommand("BackColor",!1,t(this).css("background-color"));for(var l=document.getElementsByTagName("font"),c=0,h=l.length;h>c;++c){var p=l[c].color;""!=p&&(l[c].removeAttribute("color"),l[c].style.color=p)}var m=detectIE();m&&i.find("span").each(function(){if(1==t(this).find("span").length&&t(this).text()==t(this).find("span:first").text()){var e=t(this).find("span:first").attr("style");t(this).html(t(this).find("span:first").html());var i=t(this).attr("style")+";"+e;t(this).attr("style",i)}})}else t(a).text()==o?(1==r&&(t(a).html()?t(a).css("color",t(this).css("background-color")):t(a).parent().css("color",t(this).css("background-color"))),2==r&&(t(a).html()?t(a).css("background-color",t(this).css("background-color")):t(a).parent().css("background-color",t(this).css("background-color")))):(1==r&&t(s).css("color",t(this).css("background-color")),2==r&&t(s).css("background-color",t(this).css("background-color")));3==r&&t(s).parents(".ui-draggable").children().first().css("background-color",t(this).css("background-color")),e.preventDefault(),t(this).blur(),d.data("contenteditor").onChanged(),t("#md-color").data("simplemodal").hide()}),t("#btnCleanColor").unbind("click"),t("#btnCleanColor").click(function(){restoreSelection(n);var e,i;window.getSelection?(i=window.getSelection().getRangeAt(0).commonAncestorContainer,e=window.getSelection().getRangeAt(0).commonAncestorContainer.parentNode):document.selection&&(i=document.selection.createRange(),e=document.selection.createRange().parentElement());var s=t("#selColorApplyTo").val();if(""!=t.trim(o)&&t(i).text()!=o){1==s&&document.execCommand("ForeColor",!1,""),2==s&&document.execCommand("BackColor",!1,"");for(var a=document.getElementsByTagName("font"),r=0,l=a.length;l>r;++r){var d=a[r].color;a[r].removeAttribute("color"),a[r].style.color=d}}else t(i).text()==o?(1==s&&(t(i).html()?t(i).css("color",""):t(i).parent().css("color","")),2==s&&(t(i).html()?t(i).css("background-color",""):t(i).parent().css("background-color",""))):(1==s&&t(e).css("color",""),2==s&&t(e).css("background-color",""));3==s&&t(i).parents(".ui-draggable").children().first().css("background-color",""),t("#md-color").data("simplemodal").hide()})}),t('#rte-toolbar .btn[data-rte-cmd="fontsize"]').unbind("click"),t('#rte-toolbar .btn[data-rte-cmd="fontsize"]').click(function(e){var i=saveSelection(),n=null;n=t(getSelectionStartNode()).css("font-size").replace(/"/g,"");var o=function(){var e,i=t("#ifrFontSize").contents();i.find("#divFontSize div.active").removeClass("active"),e=i.find('#divFontSize div[data-font-size="'+n+'"]'),e.addClass("active"),i.scrollTop(e.offset().top-130)};t("#md-fontsize").css("max-width","190px"),hideAllSimpleModals(),t("#md-fontsize").simplemodal(),t("#md-fontsize").data("simplemodal").show(),e.preventDefault(),-1==t("#ifrFontSize").attr("src").indexOf("fontsize.html")?t("#ifrFontSize").attr("src",sScriptPath+"fontsize.html").on("load",function(){o()}):o();var s=getSelected();t(".md-pickfontsize").unbind("click"),t(".md-pickfontsize").click(function(){restoreSelection(i);var n,o;window.getSelection?(o=window.getSelection().getRangeAt(0).commonAncestorContainer,n=window.getSelection().getRangeAt(0).commonAncestorContainer.parentNode):document.selection&&(o=document.selection.createRange(),n=document.selection.createRange().parentElement());var a=t(this).attr("data-font-size");if(""!=t.trim(s)&&t(o).text()!=s){document.execCommand("fontSize",!1,"7");for(var r=document.getElementsByTagName("font"),l=0,c=r.length;c>l;++l)"7"==r[l].size&&(r[l].removeAttribute("size"),r[l].style.fontSize=a)}else t(o).text()==s?t(o).html()?t(o).css("font-size",a):t(o).parent().css("font-size",a):t(n).css("font-size",a);t(this).blur(),d.data("contenteditor").onChanged(),e.preventDefault(),t("#md-fontsize").data("simplemodal").hide()})}),t('#rte-toolbar .btn[data-rte-cmd="formatPara"]').unbind("click"),t('#rte-toolbar .btn[data-rte-cmd="formatPara"]').click(function(e){var i=saveSelection(),n=t(getSelectionStartNode()).closest("h1,h2,h3,h4,h5,h5,h6,p,blockquote")[0],o=n?n.tagName.replace(/"/g,"").toLowerCase():null,s=function(){var e,i=t("#ifrHeadings").contents();i.find("#divHeadings div.active").removeClass("active"),o&&(e=i.find('#divHeadings div[data-heading="'+o+'"]'),e.addClass("active"),i.scrollTop(e.offset().top-130))};t("#md-headings").css("max-width","225px"),hideAllSimpleModals(),t("#md-headings").simplemodal(),t("#md-headings").data("simplemodal").show(),e.preventDefault(),-1==t("#ifrHeadings").attr("src").indexOf("headings.html")?t("#ifrHeadings").attr("src",sScriptPath+"headings.html").on("load",function(){s()}):s(),t(".md-pickheading").unbind("click"),t(".md-pickheading").click(function(){restoreSelection(i);var n=t(this).attr("data-heading");d.attr("contenteditable",!0),document.execCommand("formatBlock",!1,"<"+n+">"),d.removeAttr("contenteditable"),d.data("contenteditor").render(),t(this).blur(),d.data("contenteditor").onChanged(),e.preventDefault(),t("#md-headings").data("simplemodal").hide()})}),t('#rte-toolbar .btn[data-rte-cmd="removeFormat"]').unbind("click"),t('#rte-toolbar .btn[data-rte-cmd="removeFormat"]').click(function(e){document.execCommand("removeFormat",!1,null),document.execCommand("removeFormat",!1,null),t(this).blur(),d.data("contenteditor").onChanged(),e.preventDefault()}),t('#rte-toolbar .btn[data-rte-cmd="unlink"]').unbind("click"),t('#rte-toolbar .btn[data-rte-cmd="unlink"]').click(function(e){document.execCommand("unlink",!1,null),t("#toolbar-link").removeClass("forceshow"),t(this).blur(),d.data("contenteditor").onChanged(),e.preventDefault()});var l;t('#rte-toolbar .btn[data-rte-cmd="html"]').unbind("click"),t('#rte-toolbar .btn[data-rte-cmd="html"]').click(function(e){var i;window.getSelection?i=window.getSelection().getRangeAt(0).commonAncestorContainer.parentNode:document.selection&&(i=document.selection.createRange().parentElement());var n=!1;t(i).parents().each(function(){t(this).data("contentbuilder")&&(t(this).data("contentbuilder").viewHtml(),n=!0,l=i)}),!n&&l&&(i=l,t(i).parents().each(function(){t(this).data("contentbuilder")&&t(this).data("contentbuilder").viewHtml()})),e.preventDefault()}),t('#rte-toolbar .btn[data-rte-cmd="font"]').unbind("click"),t('#rte-toolbar .btn[data-rte-cmd="font"]').click(function(e){var i=saveSelection(),n=null;n=t(getSelectionStartNode()).css("font-family").replace(/"/g,"");var o=function(){var e,i=t("#ifrFonts").contents();i.find("#divFontList div.active").removeClass("active"),e=i.find('#divFontList div[data-font-family^="'+n.split(",")[0].trim()+'"]'),e.length>0&&(e.addClass("active"),i.scrollTop(e.offset().top-130))};t("#md-fonts").css("max-width","300px"),hideAllSimpleModals(),t("#md-fonts").simplemodal(),t("#md-fonts").data("simplemodal").show(),e.preventDefault(),-1==t("#ifrFonts").attr("src").indexOf("fonts.html")?t("#ifrFonts").attr("src",sScriptPath+"fonts.html").on("load",function(){o()}):o();var s=getSelected();t(".md-pickfontfamily").unbind("click"),t(".md-pickfontfamily").click(function(){restoreSelection(i);var n,o;window.getSelection?(o=window.getSelection().getRangeAt(0).commonAncestorContainer,n=window.getSelection().getRangeAt(0).commonAncestorContainer.parentNode,"H1"!=n.nodeName&&"H2"!=n.nodeName&&"H3"!=n.nodeName&&"H4"!=n.nodeName&&"H5"!=n.nodeName&&"H6"!=n.nodeName&&"P"!=n.nodeName&&(n=n.parentNode)):document.selection&&(o=document.selection.createRange(),n=document.selection.createRange().parentElement(),"H1"!=n.nodeName&&"H2"!=n.nodeName&&"H3"!=n.nodeName&&"H4"!=n.nodeName&&"H5"!=n.nodeName&&"H6"!=n.nodeName&&"P"!=n.nodeName&&(n=n.parentElement()));var a=t(this).attr("data-font-family");if(""!=t.trim(s)&&t(o).text()!=s){document.execCommand("fontName",!1,a);for(var r=document.getElementsByTagName("font"),l=0,c=r.length;c>l;++l)r[l].face==a&&(r[l].removeAttribute("face"),r[l].style.fontFamily=a)}else t(o).text()==s?t(o).html()?t(o).css("font-family",a):t(o).parent().css("font-family",a):t(n).css("font-family",a);var h=a.split(",")[0],p=t(this).attr("data-provider");if("google"==p){for(var m=!1,u=document.getElementsByTagName("link"),l=0;l<u.length;l++){var f=u[l].href.toLowerCase();f=f.replace(/\+/g," ").replace(/%20/g," "),-1!=f.indexOf(h.toLowerCase())&&(m=!0)}m||t(n).parents().each(function(){t(this).data("contentbuilder")&&t(this).append('<link href="//fonts.googleapis.com/css?family='+h+'" rel="stylesheet" property="stylesheet" type="text/css">')})}t(cb_list).each(function(){var e=t(this);e.find("link").each(function(){var i=t(this).attr("href").toLowerCase();if(-1!=i.indexOf("googleapis")){i=i.replace(/\+/g," ").replace(/%20/g," ");var n=i.substr(i.indexOf("family=")+7);-1!=n.indexOf(":")&&(n=n.split(":")[0]),-1!=n.indexOf("|")&&(n=n.split("|")[0]);var o=e.data("contentbuilder").html().toLowerCase(),s=o.split(n).length;3>s&&t(this).attr("rel","_del")}})}),d.find('[rel="_del"]').remove(),t(this).blur(),d.data("contenteditor").onChanged(),e.preventDefault(),t("#md-fonts").data("simplemodal").hide()})}),t('#rte-toolbar .btn[data-rte-cmd="align"]').unbind("click"),t('#rte-toolbar .btn[data-rte-cmd="align"]').click(function(e){var i=saveSelection();t("#md-align").css("max-width","200px"),hideAllSimpleModals(),t("#md-align").simplemodal(),t("#md-align").data("simplemodal").show(),e.preventDefault(),t(".md-pickalign").unbind("click"),t(".md-pickalign").click(function(){restoreSelection(i);var n;window.getSelection?(n=window.getSelection().getRangeAt(0).commonAncestorContainer.parentNode,"H1"!=n.nodeName&&"H2"!=n.nodeName&&"H3"!=n.nodeName&&"H4"!=n.nodeName&&"H5"!=n.nodeName&&"H6"!=n.nodeName&&"P"!=n.nodeName&&(n=n.parentNode)):document.selection&&(n=document.selection.createRange().parentElement(),"H1"!=n.nodeName&&"H2"!=n.nodeName&&"H3"!=n.nodeName&&"H4"!=n.nodeName&&"H5"!=n.nodeName&&"H6"!=n.nodeName&&"P"!=n.nodeName&&(n=n.parentElement()));var o=t(this).data("align");n.style.textAlign=o,e.preventDefault(),t(this).blur(),d.data("contenteditor").onChanged(),t("#md-align").data("simplemodal").hide()})}),t('#rte-toolbar .btn[data-rte-cmd="list"]').unbind("click"),t('#rte-toolbar .btn[data-rte-cmd="list"]').click(function(e){var n=saveSelection();t("#md-list").css("max-width","202px"),hideAllSimpleModals(),t("#md-list").simplemodal(),t("#md-list").data("simplemodal").show(),e.preventDefault(),t(".md-picklist").unbind("click"),t(".md-picklist").click(function(){restoreSelection(n);var e=t(this).data("list");try{"normal"==e?(document.execCommand("outdent",!1,null),document.execCommand("outdent",!1,null),document.execCommand("outdent",!1,null)):document.execCommand(e,!1,null)}catch(o){i.parents("div").addClass("edit");var s;window.getSelection?(s=window.getSelection().getRangeAt(0).commonAncestorContainer.parentNode,s=s.parentNode):document.selection&&(s=document.selection.createRange().parentElement(),s=s.parentElement()),s.setAttribute("contenteditable",!0),"normal"==e?(document.execCommand("outdent",!1,null),document.execCommand("outdent",!1,null),document.execCommand("outdent",!1,null)):document.execCommand(e,!1,null),s.removeAttribute("contenteditable"),d.data("contenteditor").render()}o.preventDefault(),t(this).blur(),d.data("contenteditor").onChanged(),t("#md-list").data("simplemodal").hide()})}),t('#rte-toolbar .btn[data-rte-cmd="createLink"]').unbind("click"),t('#rte-toolbar .btn[data-rte-cmd="createLink"]').click(function(i){i.preventDefault();var n="";if("undefined"!=typeof window.getSelection){var o=window.getSelection();if(o.rangeCount){for(var s=document.createElement("div"),a=0,r=o.rangeCount;r>a;++a)s.appendChild(o.getRangeAt(a).cloneContents());n=s.innerHTML}}else"undefined"!=typeof document.selection&&"Text"==document.selection.type&&(n=document.selection.createRange().htmlText);if(""==n)return alert("Please select some text."),i.preventDefault(),void i.stopImmediatePropagation();var l;window.getSelection?l=window.getSelection().getRangeAt(0).commonAncestorContainer:document.selection&&(l=document.selection.createRange()),"a"==l.nodeName.toLowerCase()?e=t(l):"i"==l.parentNode.nodeName.toLowerCase()?(t(l.parentNode).wrap('<a href=""></a>'),e=t(l).closest("a")):"i"==l.nodeName.toLowerCase()?(t(l).wrap('<a href=""></a>'),e=t(l).closest("a")):(document.execCommand("createLink",!1,"http://dummy"),e=t("a[href='http://dummy']").first(),e.attr("href","")),t("#md-createlink").css("max-width","800px"),t("#md-createlink").simplemodal({onCancel:function(){""==e.attr("href")&&e.replaceWith(e.html())}}),t("#md-createlink").data("simplemodal").show(),t("#txtLink").val(e.attr("href").replace("mailto:","")),t("#txtLinkText").val(e.html()),t("#btnLinkOk").unbind("click"),t("#btnLinkOk").bind("click",function(i){var n=t("#txtLink").val();e.attr("href",toHref(n)),("http://"==t("#txtLink").val()||""==t("#txtLink").val())&&e.replaceWith(e.html()),e.html(t("#txtLinkText").val()),e.attr("target","_blank"),d.data("contenteditor").render(),d.data("contenteditor").onChanged(),t("#md-createlink").data("simplemodal").hide(),selectNodeContents(e[0])})}),t('#rte-toolbar .btn[data-rte-cmd="icon"]').unbind("click"),t('#rte-toolbar .btn[data-rte-cmd="icon"]').click(function(t){$savedSel=saveSelection(),$activeIcon=null,d.data("contenteditor").openIconSelectModal(),t.preventDefault()}),d.find(".embed-responsive").unbind("hover"),d.find(".embed-responsive").hover(function(e){if(!(t(this).parents("[data-mode='code']").length>0||t(this).parents("[data-mode='readonly']").length>0)){var i,s,a=t(this).offset().top,r=t(this).offset().left;i=a-30,s=r,t("#toolbar-frame").css("top",i+"px"),t("#toolbar-frame").css("left",s+"px"),t("#toolbar-frame").stop(!0,!0).css({display:"none"}).fadeIn(20),n=t(this).find("iframe"),t("#toolbar-frame").unbind("click"),t("#toolbar-frame").bind("click",function(e){t("#md-createsrc").css("max-width","800px"),hideAllSimpleModals(),t("#md-createsrc").simplemodal(),t("#md-createsrc").data("simplemodal").show(),t("#videoSrc").val(n.attr("src")),t("#btnSrcOk").unbind("click"),t("#btnSrcOk").bind("click",function(e){var i=t("#videoSrc").val(),s=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/,a=/^.*(vimeo\.com\/)((channels\/[A-z]+\/)|(groups\/[A-z]+\/videos\/)|(video\/))?([0-9]+)\/?/,r=/^.*(drive\.google\.com\/file\/d\/)([0-9A-Za-z\-\.\_]{25,})\/?/,l=/^.*(docs\.google\.com\/).*?\/([0-9A-Za-z\-\.\_]{25,})\/?/,c=/^.*slideshare\.net\/slideshow\/embed_code\/key\/([0-9A-Za-z\-\.\_]+)\/?/,h=s.exec(i),p=a.exec(i),m=r.exec(i),u=l.exec(i),f=c.exec(i);if(null!=h&&h.length>=8){var g=h[7];i="//www.youtube.com/embed/"+g+"?rel=0"}else if(null!=p&&p.length>=7){var v=p[6];i="//player.vimeo.com/video/"+v}else if(null!=m&&m.length>=3){var b=m[2];i="//drive.google.com/file/d/"+b+"/preview"}else if(null!=u&&u.length>=3){var w=u[2];/\/embed/.exec(i)||(i="//docs.google.com/presentation/d/"+w+"/embed")}else{if(!(null!=f&&f.length>=2))return t("#md-createsrc").data("simplemodal").hide(),void d.data("contentbuilder").settings.onVideoTypeNotSupported();var y=f[1];i="//www.slideshare.net/slideshow/embed_code/key/"+y}n.attr("src",i),""==t("#videoSrc").val()&&n.attr("src",""),t("#md-createsrc").data("simplemodal").hide();for(var x=0;x<o.length;x++)t(o[x]).data("contenteditor").render()})}),t("#toolbar-frame").hover(function(e){t(this).stop(!0,!0).css("display","block")},function(){t(this).stop(!0,!0).fadeOut(0)})}},function(e){t("#toolbar-frame").stop(!0,!0).fadeOut(200)}),d.find("a").not(".not-a").unbind("hover"),d.find("a").not(".not-a").hover(function(i){if(!(t(this).parents("[data-mode='code']").length>0||t(this).parents("[data-mode='readonly']").length>0||1==t(this).children("img").length&&1==t(this).children().length)){var n,s,a=t(this).offset().top,r=t(this).offset().left;n=a-30,s=r,t("#toolbar-link").css("top",n+"px"),t("#toolbar-link").css("left",s+"px"),1==t(this).children("i.fa").length&&1==t(this).children().length?($activeIcon=t(this).find("i.fa"),t("#toolbar-link .edit-link-icon, #toolbar-link .divider").show()):t("#toolbar-link .edit-link-icon, #toolbar-link .divider").hide(),t("#toolbar-link").stop(!0,!0).css({display:"none"}).fadeIn(20),e=t(this),t("#toolbar-link .edit-link").unbind("click"),t("#toolbar-link .edit-link").bind("click",function(i){t("#md-createlink").css("max-width","550px"),t("#md-createlink").simplemodal({onCancel:function(){"http://"==e.attr("href")&&e.replaceWith(e.html())}}),t("#md-createlink").data("simplemodal").show(),t("#txtLink").val(e.attr("href").replace("mailto:","").replace("mailto:","")),t("#txtLinkText").val(e.html()),t("#btnLinkOk").unbind("click"),t("#btnLinkOk").bind("click",function(i){var n=t("#txtLink").val();e.attr("href",toHref(n)),("http://"==t("#txtLink").val()||""==t("#txtLink").val())&&e.replaceWith(e.html()),e.html(t("#txtLinkText").val()),e.attr("target","_blank"),t("#md-createlink").data("simplemodal").hide();for(var s=0;s<o.length;s++)t(o[s]).data("contenteditor").render()})}),t("#toolbar-link .edit-link-icon").unbind("click"),t("#toolbar-link .edit-link-icon").bind("click",function(){d.data("contenteditor").openIconSelectModal()}),t("#toolbar-link").hover(function(e){t(this).stop(!0,!0).css("display","block")},function(){t(this).stop(!0,!0).fadeOut(0)})}},function(e){t("#toolbar-link").stop(!0,!0).fadeOut(200)}),t("#btnLinkBrowse").unbind("click"),t("#btnLinkBrowse").bind("click",function(e){t("#toolbar-img-upload").stop(!0,!0).fadeOut(0),t("#toolbar-img-settings").stop(!0,!0).fadeOut(0),t("#toolbar-link").stop(!0,!0).fadeOut(0),t("#toolbar-frame").stop(!0,!0).fadeOut(0);var i=(d.data("contenteditor").settings.onFileSelectClick+"").replace(/\s/g,"");"function(){}"!=i?d.data("contenteditor").settings.onFileSelectClick({targetInput:t("#txtLink").get(0),theTrigger:t("#btnLinkBrowse").get(0)}):(t("#ifrFileBrowse").attr("src",d.data("contenteditor").settings.fileselect),t("#active-input").val("txtLink"),t("#md-fileselect").css("width","65%"),hideAllSimpleModals(),t("#md-fileselect").simplemodal(),t("#md-fileselect").data("simplemodal").show())}),d.data("contenteditor").settings.onRender(),d.data("contenteditor").applyIconBehavior()},this.prepareRteCommand=function(e){t('#rte-toolbar .btn[data-rte-cmd="'+e+'"]').unbind("click"),t('#rte-toolbar .btn[data-rte-cmd="'+e+'"]').click(function(i){try{document.execCommand(e,!1,null)}catch(i){d.attr("contenteditable",!0),document.execCommand(e,!1,null),d.removeAttr("contenteditable"),d.data("contenteditor").render()}t(this).blur(),d.data("contenteditor").onChanged(),i.preventDefault()})},this.init()},t.fn.contenteditor=function(e){return this.each(function(){if(o.push(this),void 0==t(this).data("contenteditor")){var i=new t.contenteditor(this,e);t(this).data("contenteditor",i)}})}}(jQuery);var getSelectedNode=function(){var t,e;if(window.getSelection&&(e=getSelection(),t=e.anchorNode),!t&&document.selection){e=document.selection;var i=e.getRangeAt?e.getRangeAt(0):e.createRange();t=i.commonAncestorContainer?i.commonAncestorContainer:i.parentElement?i.parentElement():i.item(0)}return t?"#text"==t.nodeName?t.parentNode:t:void 0},$savedSel,$activeIcon,$imgActive;!function(t){var e,i,n;t.imageembed=function(o,s){var a={hiquality:!1,imageselect:"",fileselect:"",imageEmbed:!0,linkDialog:!0,zoom:0,customval:0,largerImageHandler:"",onChanged:function(){},onImageBrowseClick:function(){},onImageSettingClick:function(){},onImageSelectClick:function(){},onFileSelectClick:function(){}};this.settings={};var r=t(o),o=o;this.init=function(){this.settings=t.extend({},a,s),0==t("#divCb").length&&t("body").append('<div id="divCb"></div>');var i="",n="";-1!=navigator.appName.indexOf("Microsoft")?(i='<div id="toolbar-img-upload" class="toolbar"><div class="fileinputs"><input type="file" name="fileImage" id="fileImage" class="my-file" /><div class="fakefile"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA8CAYAAAA6/NlyAAAC+klEQVRoQ+2au24aQRSGz+ySkEvPA9AQubNEhXgCSogEShmZGkSQpTS8AjUNSAjXlCRNStpQ8QK8AI6UOLazM5lZvGRvswsz43hYz0iWZe3uzPnOf25rQOVymcAzWsgAZ1xto3DGBQajsFE4Yx4wIZ0xQSM4RmGjcMY8YEI6Y4LKFy0H/9TCJ7b1VsiOo0PaAAv5Wf4ho/CBPjQhneYokRyezWZQKpW4WzuOA71eD5bLZdrx++vahnSz2YRutwu5XC4RZrPZQL1eP33g4XAI1Wo1FeRYlbVQ+FA1U+kfblitVtBut2Nvf3LgQqEAk8kE2G9VC2MM4/EYRqNRZMsnBy4WizCdTiGfz6vidffhqaw98Ha7hU6nA+v1OuCQfr8PLBV46ySB/bAeoL8qJ0GfHLA/D8P9OOmap/jJAXvq1mq12NB1lW404LL/GVqtD5QTPfwwZEJz+DtcXHwEDPf0z3+f+2mbw17oxvZjhIBgGz71LqFSqcQ6xK8wgT+AyZ0L/t+AMflNz3MiNYZXpXkKI2SDhfKw3V67xYwXAdGQJhT6lj77SqgbHP3ywMLMITeB8GIn84C9PJ3P5/s+vYPdGbxYLGAwGABv3k4aPkSIBYAZMg0tfBs4L6kP+yvy7OoKzt6dg3+UTJrQtABmpOHQThs8PGjbeuMrSuDmbdLLhTbAYZXTgJmTEMrBj+sbbs6yPb1KzMIewOJOWiLh7Nog85UH/7vxobO0bb12QYJrV4jCxZA56OuXb26Oq1pSwOGwTgtPz2gLvaRqv9gzOORXpAiyiywN3jdagXtlwaWACbnf9UWBxdRjbWmnLA1l3qK92kYs79UsOeCYaq3GrOAuokNGnC1SwLRWg4NpT37kpREwHUIwzb9HXs8LWKccZsKK/Nv24IBwYdkIGm5jB+8QuVEyh+WA2XDBqjVygfyvheJAaU9KA6cdoNt1A6ybIqrtMQqr9qhu+xmFdVNEtT1GYdUe1W0/o7Buiqi2xyis2qO67WcU1k0R1fb8BZv85KDCNGIQAAAAAElFTkSuQmCC" /></div></div></div>',n=""):(i='<div style="display:none"><input type="file" name="fileImage" id="fileImage" class="my-file"></div>',n='<div id="toolbar-img-upload" class="toolbar"><i id="btn-upload-img" class="fa fa-camera"></i></div>');var o='<div id="divTempContent" style="display:none"></div><div class="overlay-bg" style="position:fixed;top:0;left:0;width:1;height:1;z-index:10000;zoom 1;background:#fff;opacity:0.8"></div><div id="divImageEdit" style="position:absolute;display:none;z-index:10000"><div id="my-mask" style="width:200px;height:200px;overflow:hidden;"><img id="my-image" src="" style="max-width:none" /><img id="my-image-nocrop" src="" style="max-width:none" /></div><div id="img-control" style="position:absolute;top:-27px;left:0px;"><button id="btnImageCancel" class="btn btn-sm btn-default" type="button" value="Cancel" ><i class="fa fa-reply"></i></button><button id="btnZoomOut" class="btn btn-sm btn-default" type="button" value="-" ><i class="fa fa-minus"></i></button><button id="btnZoomIn" class="btn btn-sm btn-default" type="button" value="+" ><i class="fa fa-plus"></i></button><button id="btnChangeImage" class="btn btn-sm btn-success" type="button" value="Ok" ><i class="fa fa-crop"></i> Crop</button><button id="btnChangeImageNoCrop" class="btn btn-sm btn-success" type="button" value="No Crop" ><i class="fa fa-check"></i> No Crop</button></div></div><div style="display:none"><canvas id="myCanvas"></canvas><canvas id="myTmpCanvas"></canvas><canvas id="myTmpCanvasNoCrop"></canvas></div><form id="canvasform" name="canvasform" method="post" action="" target="canvasframe" enctype="multipart/form-data">'+i+'<input id="hidRefId" name="hidRefId" type="hidden" value="'+this.settings.customval+'" /></form><iframe id="canvasframe" name="canvasframe" style="width:1px;height:1px;border:none;visibility:hidden;position:absolute"></iframe>',c=!1;
""!=this.settings.imageselect&&(c=!0);var h=(this.settings.onImageSelectClick+"").replace(/\s/g,"");"function(){}"!=h&&(c=!0);var p=!1;""!=this.settings.fileselect&&(p=!0);var h=(this.settings.onFileSelectClick+"").replace(/\s/g,"");"function(){}"!=h&&(p=!0);var m=this.settings.imageEmbed,u=n+'<div id="toolbar-img-settings" class="toolbar"><i id="btn-img-settings" class="fa fa-link"></i></div><div id="divToolImgLoader"><i id="lnkImageLoader" class="fa fa-refresh fa-spin"></i></div><div class="md-modal" id="md-img"><div class="md-content"><div class="md-body"><div id="divImgLnk"><div class="md-label">Source:</div>'+(c?'<input type="text" id="txtImgUrl" class="inptxt" style="float:left;width:50%"></input><i class="fa fa-link md-btnbrowse" id="btnImageBrowse" style="width:10%;"></i>':'<input type="text" id="txtImgUrl" class="inptxt" style="float:left;width:60%"></input>')+'<br style="clear:both"><div class="md-label">Title:</div><input type="text" id="txtAltText" class="inptxt" style="float:right;width:60%"></input><br style="clear:both"><div class="md-label">Link:</div>'+(p?'<input type="text" id="txtLinkUrl" class="inptxt" style="float:left;width:50%"></input><i class="fa fa-link md-btnbrowse" id="btnFileBrowse" style="width:10%;"></i>':'<input type="text" id="txtLinkUrl" class="inptxt" style="float:left;width:60%"></input>')+'<br style="clear:both"><div id="divEmbedOriginal"><div class="md-label">&nbsp;</div><label style="float:left;" for="chkCrop" class="inpchk"><input type="checkbox" id="chkCrop"></input> Crop</label><br style="clear:both" /></div></div></div><div id="divImgLnkOk" class="md-footer"><button id="btnImgOk"> Ok </button></div></div></div><div class="md-modal" id="md-imageselect"><div class="md-content"><div class="md-body">'+(c?'<iframe id="ifrImageBrowse" style="width:100%;height:400px;border: none;display: block;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJCAYAAADgkQYQAAAAFElEQVQYV2P8DwQMBADjqCKiggAAmZsj5vuXmnUAAAAASUVORK5CYII="></iframe>':"")+"</div></div></div>";0==t("#md-fileselect").length&&(u+='<div class="md-modal" id="md-fileselect"><div class="md-content"><div class="md-body">'+(p?'<iframe id="ifrFileBrowse" style="width:100%;height:400px;border: none;display: block;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAJCAYAAADgkQYQAAAAFElEQVQYV2P8DwQMBADjqCKiggAAmZsj5vuXmnUAAAAASUVORK5CYII="></iframe>':"")+"</div></div></div>"),0==t("#active-input").length&&(u+='<input type="hidden" id="active-input" />'),0==t("#toolbar-img-upload").length&&(t("#divCb").append(o),t("#divCb").append(u)),e=document.getElementById("myTmpCanvas"),r.hover(function(e){var i;null!=localStorage.getItem("zoom")?i=localStorage.zoom:(i=r.parents('[style*="zoom"]').css("zoom"),"normal"==i&&(i=1),void 0==i&&(i=1));var n=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;i+="",-1!=i.indexOf("%")&&(i=i.replace("%","")/100),"NaN"==i&&(i=1),localStorage.zoom=i,i=1*i,""==cb_list&&(i=1),1==r.data("imageembed").settings.zoom&&(i=1);var o,s,a,c=t(window).scrollTop(),h=t(this).offset().top,p=t(this).offset().left,n=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,u=detectIE(),f=detectEdge(),g=!0;(n||u||f)&&(g=!1);var v=t(this).data("imageembed").settings.imageEmbed?-35:9;if(g)o=(h+parseInt(t(this).css("height"))/2-15)*i+(c-c*i),a=(p+parseInt(t(this).css("width"))/2-15)*i,s=o+v;else{if(u){var b=0,w=0;r.parents().each(function(){t(this).data("contentbuilder")&&(b=t(this).getPos().top,w=t(this).getPos().left)});var y=-b*i+b,x=-w*i+w,C=t(this).getPos();o=(C.top-15+parseInt(t(this).css("height"))/2)*i+y,a=(C.left-15+parseInt(t(this).css("width"))/2)*i+x,s=o+v}if(n){var k=parseInt(t(this).css("width")),A=parseInt(t(this).css("height"));o=h-15+A*i/2,a=p-15+k*i/2,s=o+v}}var S=!1;$imgActive=t(this),1==$imgActive.attr("data-fixed")&&(S=!0),cb_edit&&!S&&(t("#toolbar-img-upload").css("top",o+"px"),t("#toolbar-img-upload").css("left",a+"px"),t(this).data("imageembed").settings.imageEmbed&&t("#toolbar-img-upload").stop(!0,!0).css({display:"none"}).fadeIn(20),t(this).data("imageembed").settings.linkDialog?(t("#toolbar-img-settings").css("top",s+"px"),t("#toolbar-img-settings").css("left",a+"px"),t("#toolbar-img-settings").stop(!0,!0).css({display:"none"}).fadeIn(20)):t("#toolbar-img-settings").css("top","-10000px")),(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i))&&t("#btn-img-settings").on("touchstart mouseenter focus",function(e){"touchstart"==e.type&&(e.stopImmediatePropagation(),e.preventDefault()),t("#btn-img-settings").click(),e.preventDefault(),e.stopImmediatePropagation()}),t("#toolbar-img-upload").unbind("click"),t("#toolbar-img-upload").bind("click",function(e){t("#toolbar-img-upload").data("image",$imgActive);var i=(r.data("imageembed").settings.onImageBrowseClick+"").replace(/\s/g,"");"function(){}"!=i?r.data("imageembed").settings.onImageBrowseClick():t("input.my-file[type=file]").click(),e.preventDefault(),e.stopImmediatePropagation()}),t("#toolbar-img-upload").unbind("hover"),t("#toolbar-img-upload").hover(function(e){m&&t("#toolbar-img-upload").stop(!0,!0).css("display","block"),t("#toolbar-img-settings").stop(!0,!0).css("display","block")},function(){t("#toolbar-img-upload").stop(!0,!0).fadeOut(0),t("#toolbar-img-settings").stop(!0,!0).fadeOut(0)}),r.find("figcaption").unbind("hover"),r.find("figcaption").hover(function(e){m&&t("#toolbar-img-upload").stop(!0,!0).css("display","block"),t("#toolbar-img-settings").stop(!0,!0).css("display","block")},function(){t("#toolbar-img-upload").stop(!0,!0).fadeOut(0),t("#toolbar-img-settings").stop(!0,!0).fadeOut(0)}),t("#toolbar-img-settings").unbind("hover"),t("#toolbar-img-settings").hover(function(e){m&&t("#toolbar-img-upload").stop(!0,!0).css("display","block"),t("#toolbar-img-settings").stop(!0,!0).css("display","block")},function(){t("#toolbar-img-upload").stop(!0,!0).fadeOut(0),t("#toolbar-img-settings").stop(!0,!0).fadeOut(0)}),t("#btn-img-settings").unbind("click"),t("#btn-img-settings").bind("click",function(e){t("#toolbar-img-upload").data("image",$imgActive),t("#toolbar-img-upload").stop(!0,!0).fadeOut(0),t("#toolbar-img-settings").stop(!0,!0).fadeOut(0);var i=(r.data("imageembed").settings.onImageSettingClick+"").replace(/\s/g,"");if("function(){}"!=i)return void r.data("imageembed").settings.onImageSettingClick();t("#md-img").css("max-width","800px"),hideAllSimpleModals(),t("#md-img").simplemodal(),t("#md-img").data("simplemodal").show();var n=r;"figure"==r.prop("tagName").toLowerCase()&&(n=r.find("img:first")),t("#txtImgUrl").val(n.attr("src")),t("#txtAltText").val(n.attr("alt")),t("#txtLinkUrl").val(""),void 0!=n.parents("a:first")&&t("#txtLinkUrl").val(n.parents("a:first").attr("href")),r.data("imageembed").settings.imageEmbed||t("#divEmbedOriginal").css("display","none"),t("#chkCrop").removeAttr("checked"),t("#btnImgOk").unbind("click"),t("#btnImgOk").bind("click",function(e){var i;r.parents().each(function(){t(this).data("contentbuilder")&&(i=t(this).data("contentbuilder"))});var o=!1;if(t("#chkCrop").is(":checked")||(o=!0),0==o&&-1!=t("#txtImgUrl").val().indexOf("http")&&(o=!0),n.attr("src")!=t("#txtImgUrl").val()&&(o?(-1!=n.attr("src").indexOf(sScriptPath+"image.png")&&-1==t("#txtImgUrl").val().indexOf(sScriptPath+"image.png")&&(n.css("width",""),n.css("height","")),n.attr("src",t("#txtImgUrl").val())):d(t("#txtImgUrl").val())),n.attr("alt",t("#txtAltText").val()),"http://"==t("#txtLinkUrl").val()||""==t("#txtLinkUrl").val())n.parents("a:first").replaceWith(n.parents("a:first").html());else{var s=t("#txtLinkUrl").val();0==n.parents("a:first").length?n.wrap('<a href="'+s+'"></a>'):n.parents("a:first").attr("href",s),n.parents("a:first").attr("title",t("#txtAltText").val()),-1!=s.toLowerCase().indexOf(".jpg")||-1!=s.toLowerCase().indexOf(".jpeg")||-1!=s.toLowerCase().indexOf(".png")||-1!=s.toLowerCase().indexOf(".gif")?(n.parents("a:first").addClass("is-lightbox"),n.parents("a:first").attr("target","_blank")):(n.parents("a:first").removeClass("is-lightbox"),n.parents("a:first").removeAttr("target"))}i&&i.applyBehavior(),t("#md-img").data("simplemodal").hide()}),e.preventDefault(),e.stopImmediatePropagation()}),t("#btnImageBrowse").unbind("click"),t("#btnImageBrowse").bind("click",function(e){t("#toolbar-img-upload").stop(!0,!0).fadeOut(0),t("#toolbar-img-settings").stop(!0,!0).fadeOut(0),t("#toolbar-link").stop(!0,!0).fadeOut(0),t("#toolbar-frame").stop(!0,!0).fadeOut(0);var i=(r.data("imageembed").settings.onImageSelectClick+"").replace(/\s/g,"");"function(){}"!=i?r.data("imageembed").settings.onImageSelectClick({targetInput:t("#txtImgUrl").get(0),theTrigger:t("#btnImageBrowse").get(0)}):(t("#ifrImageBrowse").attr("src",r.data("imageembed").settings.imageselect),t("#active-input").val("txtImgUrl"),t("#md-imageselect").css("width","65%"),hideAllSimpleModals(),t("#md-imageselect").simplemodal(),t("#md-imageselect").data("simplemodal").show())}),t("#btnFileBrowse").unbind("click"),t("#btnFileBrowse").bind("click",function(e){t("#toolbar-img-upload").stop(!0,!0).fadeOut(0),t("#toolbar-img-settings").stop(!0,!0).fadeOut(0),t("#toolbar-link").stop(!0,!0).fadeOut(0),t("#toolbar-frame").stop(!0,!0).fadeOut(0);var i=(r.data("imageembed").settings.onFileSelectClick+"").replace(/\s/g,"");"function(){}"!=i?r.data("imageembed").settings.onFileSelectClick({targetInput:t("#txtLinkUrl").get(0),theTrigger:t("#btnFileBrowse").get(0)}):(t("#ifrFileBrowse").attr("src",r.data("imageembed").settings.fileselect),t("#active-input").val("txtLinkUrl"),t("#md-fileselect").css("width","65%"),hideAllSimpleModals(),t("#md-fileselect").simplemodal(),t("#md-fileselect").data("simplemodal").show())}),t(".my-file[type=file]").unbind("change"),t(".my-file[type=file]").bind("change",function(e){l(e),t("#my-image").attr("src",""),$imgActive.parent().hasClass("is-lightbox")||t(this).clearInputs()})},function(e){t("#toolbar-img-upload").stop(!0,!0).fadeOut(0),t("#toolbar-img-settings").stop(!0,!0).fadeOut(0)})};var l=function(e){if("undefined"==typeof FileReader)return!0;var i=e.target.files[0],n=i.name.substr(i.name.lastIndexOf(".")+1).toLowerCase();return"jpg"!=n&&"jpeg"!=n&&"png"!=n&&"gif"!=n&&"bmp"!=n?void alert("Please select an image"):(t("#toolbar-img-upload").stop(!0,!0).fadeOut(0),t("#toolbar-img-settings").stop(!0,!0).fadeOut(0),t(".overlay-bg").css("width","100%"),t(".overlay-bg").css("height","100%"),t("#divToolImgLoader").css("top",t("#toolbar-img-upload").css("top")),t("#divToolImgLoader").css("left",t("#toolbar-img-upload").css("left")),t("#divToolImgLoader").css("display","block"),void d(i))},d=function(o){var s,a;o.name?(s=o.name,a=o.name.substr(o.name.lastIndexOf(".")+1).toLowerCase()):(s=o.substr(o.lastIndexOf("/")+1),a=o.substr(o.lastIndexOf(".")+1).toLowerCase());var l=!1;try{l=r.data("imageembed").settings.hiquality}catch(d){}var p,m;0==l&&("jpg"==a||"jpeg"==a)?(p="image/jpeg",m=.92):(p="image/png",m=1),loadImage.parseMetaData(o,function(d){var u;d.exif&&(u=d.exif.get("Orientation")),loadImage(o,function(o){var d,f;o.width>3200||o.height>3200?(d=o.width/2,f=o.height/2):o.width>2500||o.height>2500?(d=o.width/1.25,f=o.height/1.25):(d=o.width,f=o.height),5==u||6==u||7==u||8==u?(e.width=f,e.height=d,i=f,n=d):(e.width=d,e.height=f,i=d,n=f);var g,v,b,w=document.getElementById("myTmpCanvasNoCrop");if(5==u||6==u||7==u||8==u){w.width=f,w.height=d;var y=w.getContext("2d");y.drawImage(o,0,0,f,d),b=w.toDataURL(p,m),f<=$imgActive.width()&&d<=$imgActive.height()?(g=f,v=d):$imgActive.width()<70?(g=$imgActive.parent().width()/f*d,v=$imgActive.parent().width()):(g=$imgActive.width()/f*d,v=$imgActive.width()),t("#my-image-nocrop").css("width",v+"px"),t("#my-image-nocrop").css("height",g+"px")}else{w.width=d,w.height=f;var y=w.getContext("2d");y.drawImage(o,0,0,d,f),b=w.toDataURL(p,m),d<=$imgActive.width()&&f<=$imgActive.height()?(g=d,v=f):$imgActive.width()<70?(v=$imgActive.parent().width()/d*f,g=$imgActive.parent().width()):(v=$imgActive.width()/d*f,g=$imgActive.width()),t("#my-image-nocrop").css("width",g+"px"),t("#my-image-nocrop").css("height",v+"px")}var x=w.getContext("2d");1==u?x.transform(1,0,0,1,0,0):2==u?x.transform(-1,0,0,1,g,0):3==u?x.transform(-1,0,0,-1,g,v):4==u?x.transform(1,0,0,-1,0,v):5==u?x.transform(0,1,1,0,0,0):6==u?x.transform(0,1,-1,0,v,0):7==u?x.transform(0,-1,-1,0,v,g):8==u&&x.transform(0,-1,1,0,0,g);var C,k;t("#my-image-nocrop").attr("src",b),t("#my-image-nocrop").on("load",function(){var e=t("#my-image-nocrop")[0],o=new Image;C=i,k=n,o.src=e.src,o.onload=function(){C/=2,k/=2,C<e.width&&(C=e.width),k<e.height&&(k=e.height),w.width=C,w.height=k,y=w.getContext("2d"),y.drawImage(o,0,0,C,k),C<=e.width||k<=e.height||(o.src=w.toDataURL(p,m))}});var y=e.getContext("2d");1==u?y.transform(1,0,0,1,0,0):2==u?y.transform(-1,0,0,1,d,0):3==u?y.transform(-1,0,0,-1,d,f):4==u?y.transform(1,0,0,-1,0,f):5==u?y.transform(0,1,1,0,0,0):6==u?y.transform(0,1,-1,0,f,0):7==u?y.transform(0,-1,-1,0,f,d):8==u&&y.transform(0,-1,1,0,0,d),y.drawImage(o,0,0,d,f);var A=e.toDataURL(p,m);$imgActive=t("#toolbar-img-upload").data("image");var S=localStorage.zoom;1==r.data("imageembed").settings.zoom&&(S=1);var _;"img"==$imgActive.prop("tagName").toLowerCase()?_=$imgActive[0].naturalWidth/$imgActive.width():"figure"==$imgActive.prop("tagName").toLowerCase()&&(_=$imgActive.find("img")[0].naturalWidth/$imgActive.find("img").width());var I=0,P=0;if("img"==$imgActive.prop("tagName").toLowerCase()){if(-1!=$imgActive.attr("src").indexOf(sScriptPath+"image.png"))for(var O=0;O<$imgActive.attr("style").split(";").length;O++){var L=$imgActive.attr("style").split(";")[O];"width"==t.trim(L.split(":")[0])&&(I=parseInt(t.trim(L.split(":")[1])),_=I/$imgActive.width()),"height"==t.trim(L.split(":")[0])&&(P=parseInt(t.trim(L.split(":")[1])))}}else if("figure"==$imgActive.prop("tagName").toLowerCase()&&-1!=$imgActive.find("img").attr("src").indexOf(sScriptPath+"image.png"))for(var O=0;O<$imgActive.find("img").attr("style").split(";").length;O++){var L=$imgActive.find("img").attr("style").split(";")[O];"width"==t.trim(L.split(":")[0])&&(I=parseInt(t.trim(L.split(":")[1])),_=I/$imgActive.find("img").width()),"height"==t.trim(L.split(":")[0])&&(P=parseInt(t.trim(L.split(":")[1])))}var T=0;"img"==$imgActive.prop("tagName").toLowerCase()?(t("#my-mask").css("width",$imgActive.width()*_-T+"px"),t("#my-mask").css("height",$imgActive.height()*_-T+"px")):(t("#my-mask").css("width",$imgActive.innerWidth()*_-T+"px"),t("#my-mask").css("height",$imgActive.innerHeight()*_-T+"px")),0!=I&&t("#my-mask").css("width",I+"px"),0!=P&&t("#my-mask").css("height",P+"px"),t("#my-mask").css("zoom",S/_),t("#my-mask").css("-moz-transform","scale("+S/_+")");var E,N,D=$imgActive.width(),R=$imgActive.height(),z=i/n,H=D/R;H>z?(E=D,N=n*D/i):(E=i*R/n,N=R),E*=_,N*=_,t("#my-image").attr("src",A),t("#my-image").on("load",function(){t(".overlay-bg").css("width","100%"),t(".overlay-bg").css("height","100%"),$imgActive=t("#toolbar-img-upload").data("image"),t("#my-image").css("top","0px"),t("#my-image").css("left","0px"),t("#my-image").css("width",E+"px"),t("#my-image").css("height",N+"px");var o=localStorage.zoom;o=1*o,1==r.data("imageembed").settings.zoom&&(o=1);var s,a,l,u,g=t(window).scrollTop(),v=$imgActive.offset().top,b=$imgActive.offset().left,w=navigator.userAgent.toLowerCase().indexOf("firefox")>-1,y=detectIE(),x=!0;if((w||y)&&(x=!1),x)s=v*o+(g-g*o),a=b*o,l=(v+5)*o+(g-g*o),u=(b+5)*o;else{if(y){var C=0,k=0;r.parents().each(function(){t(this).data("contentbuilder")&&(C=t(this).getPos().top,k=t(this).getPos().left)});var A=-C*o+C,S=-k*o+k,_=$imgActive.getPos();s=_.top*o+A,a=_.left*o+S,l=(_.top+5)*o+A,u=(_.left+5)*o+S}if(w){var I=parseInt($imgActive.css("width")),P=parseInt($imgActive.css("height")),S=I/2-I/2*o,A=P/2-P/2*o;t("#img-control").css("top",5+A+"px"),t("#img-control").css("left",7+S+"px"),s=v-A,a=b-S,l=v-A+5,u=b-S+5}}t("#divImageEdit").css("display","inline-block"),"img-polaroid"==$imgActive.attr("class")?(t("#divImageEdit").css("top",l+"px"),t("#divImageEdit").css("left",u+"px")):(t("#divImageEdit").css("top",s+"px"),t("#divImageEdit").css("left",a+"px")),parseInt(t("#divImageEdit").css("top"))<25&&(t("#img-control").css("top","auto"),t("#img-control").css("bottom","-24px")),h(),e.width=E,e.height=N;var O=t("#my-image")[0],L=e.getContext("2d"),w=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;w&&sleep(700);var T=new Image;d=i,f=n,T.src=O.src,T.onload=function(){return d/=2,f/=2,d<O.width&&(d=O.width),f<O.height&&(f=O.height),e.width=d,e.height=f,L=e.getContext("2d"),L.drawImage(T,0,0,d,f),d<=O.width||f<=O.height?(h(),void c()):void(T.src=e.toDataURL(p,m))},c(),"img-circle"==$imgActive.attr("class")?(t("#my-mask").css("-webkit-border-radius","500px"),t("#my-mask").css("-moz-border-radius","500px"),t("#my-mask").css("border-radius","500px")):(t("#my-mask").css("-webkit-border-radius","0px"),t("#my-mask").css("-moz-border-radius","0px"),t("#my-mask").css("border-radius","0px")),t("#my-image").unbind("load"),"img"==$imgActive.prop("tagName").toLowerCase()||(t("#btnZoomIn").click(),t("#btnZoomIn").click()),t("#divToolImgLoader").css("display","none")}),t("#btnChangeImageNoCrop").unbind("click"),t("#btnChangeImageNoCrop").bind("click",function(){var e,i=document.getElementById("myTmpCanvasNoCrop");e=0==l&&("jpg"==a||"jpeg"==a)?i.toDataURL("image/jpeg",.92):i.toDataURL("image/png",1),"img"==$imgActive.prop("tagName").toLowerCase()?($imgActive.attr("src",e),$imgActive.data("filename",s)):"figure"==$imgActive.prop("tagName").toLowerCase()?($imgActive.find("img").attr("src",e),$imgActive.find("img").data("filename",s)):($imgActive.css("background-image","url(data:"+e+")"),$imgActive.data("filename",s)),$imgActive.parent().hasClass("is-lightbox")&&(t("#canvasform").attr("action",r.data("imageembed").settings.largerImageHandler),t("#canvasform").submit()),t("#divImageEdit").css("display","none"),t(".overlay-bg").css("width","1px"),t(".overlay-bg").css("height","1px"),t("body").css("overflow",""),"img"==$imgActive.prop("tagName").toLowerCase()?($imgActive.css("width",""),$imgActive.css("height","")):"figure"==$imgActive.prop("tagName").toLowerCase()&&($imgActive.find("img").css("width",""),$imgActive.find("img").css("height","")),r.data("imageembed").settings.onChanged(),t("#divToolImgLoader").css("display","none")}),t("#btnChangeImage").unbind("click"),t("#btnChangeImage").bind("click",function(){var e=document.getElementById("myCanvas");$imgActive=t("#toolbar-img-upload").data("image");var i;i=0==l&&("jpg"==a||"jpeg"==a)?e.toDataURL("image/jpeg",.92):e.toDataURL("image/png",1),"img"==$imgActive.prop("tagName").toLowerCase()?($imgActive.attr("src",i),$imgActive.data("filename",s)):"figure"==$imgActive.prop("tagName").toLowerCase()?($imgActive.find("img").attr("src",i),$imgActive.find("img").data("filename",s)):($imgActive.css("background-image","url(data:"+i+")"),$imgActive.data("filename",s)),$imgActive.parent().hasClass("is-lightbox")&&(t("#canvasform").attr("action",r.data("imageembed").settings.largerImageHandler),t("#canvasform").submit()),t("#divImageEdit").css("display","none"),t(".overlay-bg").css("width","1px"),t(".overlay-bg").css("height","1px"),t("body").css("overflow",""),"img"==$imgActive.prop("tagName").toLowerCase()?($imgActive.css("width",""),$imgActive.css("height","")):"figure"==$imgActive.prop("tagName").toLowerCase()&&($imgActive.find("img").css("width",""),$imgActive.find("img").css("height","")),r.data("imageembed").settings.onChanged()}),t("#btnImageCancel").unbind("click"),t("#btnImageCancel").bind("click",function(){document.getElementById("myCanvas");$imgActive=t("#toolbar-img-upload").data("image"),t("#divImageEdit").css("display","none"),t(".overlay-bg").css("width","1px"),t(".overlay-bg").css("height","1px"),t("body").css("overflow","")}),t("#btnZoomIn").unbind("click"),t("#btnZoomIn").bind("click",function(){var o=parseInt(t("#my-image").css("width")),s=parseInt(t("#my-image").css("height"));t("#my-image").css("width",o/.9+"px"),t("#my-image").css("height",s/.9+"px"),h(),e.width=o/.9,e.height=s/.9;var a,r,l,d=t("#my-image")[0],a=e.getContext("2d"),u=new Image;r=i,l=n,u.src=d.src,u.onload=function(){return r/=2,l/=2,r<d.width&&(r=o/.9),l<d.height&&(l=s/.9),e.width=r,e.height=l,a=e.getContext("2d"),a.drawImage(u,0,0,r,l),o/.9>=r||s/.9>=l?(h(),void c()):void(u.src=e.toDataURL(p,m))},c()}),t("#btnZoomOut").unbind("click"),t("#btnZoomOut").bind("click",function(){var o=parseInt(t("#my-image").css("width")),s=parseInt(t("#my-image").css("height"));if(!(o/1.1<t("#my-mask").width()||s/1.1<t("#my-mask").height())){t("#my-image").css("width",o/1.1+"px"),t("#my-image").css("height",s/1.1+"px"),h(),e.width=o/1.1,e.height=s/1.1;var a,r,l,d=t("#my-image")[0],a=e.getContext("2d"),u=new Image;r=i,l=n,u.src=d.src,u.onload=function(){return r/=2,l/=2,r<d.width&&(r=o/1.1),l<d.height&&(l=s/1.1),e.width=r,e.height=l,a=e.getContext("2d"),a.drawImage(u,0,0,r,l),o/1.1>=r||s/1.1>=l?(h(),void c()):void(u.src=e.toDataURL(p,m))},c()}})},{canvas:!1})})},c=function(){var i=1.1,n=parseInt(t("#my-image").css("left"))-i,o=parseInt(t("#my-image").css("top"))-i,s=parseInt(t("#my-mask").css("width")),a=parseInt(t("#my-mask").css("height")),r=document.getElementById("myCanvas"),l=r.getContext("2d");r.width=s,r.height=a;var d=-1*n,c=-1*o;if(navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/iPad/i)){var h=.7;d=-1*n+(n-n/h),c=-1*o+(o-o/h)}c>e.height-a&&(c=e.height-a),d>e.width-s&&(d=e.width-s),l.drawImage(e,d,c,s,a,0,0,s,a)},h=function(){t("#my-image").css({top:0,left:0});var e=t("#my-mask").width(),i=t("#my-mask").height(),n=t("#my-image").offset(),o=t("#my-image").width(),s=t("#my-image").height(),a=n.left+e-o,r=n.top+i-s,l=n.left,d=n.top;t("#my-image").draggable({revert:!1,containment:[a,r,l,d],scroll:!1,drag:function(){c()}}),t("#my-image").css({cursor:"move"})};this.init()},t.fn.imageembed=function(e){return this.each(function(){if(void 0==t(this).data("imageembed")){var i=new t.imageembed(this,e);t(this).data("imageembed",i)}})}}(jQuery),jQuery.fn.clearFields=jQuery.fn.clearInputs=function(t){var e=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var i=this.type,n=this.tagName.toLowerCase();e.test(i)||"textarea"==n?this.value="":"checkbox"==i||"radio"==i?this.checked=!1:"select"==n?this.selectedIndex=-1:"file"==i?/MSIE/.test(navigator.userAgent)?jQuery(this).replaceWith(jQuery(this).clone(!0)):jQuery(this).val(""):t&&(t===!0&&/hidden/.test(i)||"string"==typeof t&&jQuery(this).is(t))&&(this.value="")})};var zindex=1e4;!function(t){t.simplemodal=function(e,i){var n={onCancel:function(){}};this.settings={};var o,s=t(e),e=e;this.init=function(){this.settings=t.extend({},n,i),0==t("#divCb").length&&t("body").append('<div id="divCb"></div>')},this.hide=function(){s.css("display","none"),s.removeClass("md-show"),o.remove(),zindex-=2},this.show=function(){zindex+=1;var e=makeid(),i='<div id="md-overlay-'+e+'" class="md-overlay" style="z-index:'+zindex+'"></div>';if(t("#divCb").append(i),o=t("#md-overlay-"+e),zindex+=1,s.css("z-index",zindex),s.addClass("md-show"),s.stop(!0,!0).css("display","none").fadeIn(200),s.hasClass("md-draggable")){var n=parseInt(s.css("width")),a=parseInt(s.css("height"));s.css("top",Math.max(0,(t(window).height()-a)/2)+"px"),s.css("left",Math.max(0,(t(window).width()-n)/2)+"px"),s.find(".md-modal-handle").length>0?(s.find(".md-modal-handle").css("cursor","move"),s.draggable({handle:".md-modal-handle"})):s.draggable()}t("#md-overlay-"+e).unbind(),t("#md-overlay-"+e).click(function(){s.stop(!0,!0).fadeOut(100,function(){s.removeClass("md-show")}),o.remove(),zindex-=2,s.data("simplemodal").settings.onCancel()})},this.init()},t.fn.simplemodal=function(e){return this.each(function(){if(void 0==t(this).data("simplemodal")){var i=new t.simplemodal(this,e);t(this).data("simplemodal",i)}})}}(jQuery),jQuery.fn.getPos=function(){var t=this[0],e=0,i=0,n=null;n=t.offsetParent;for(var o=t,s=t;null!=s.parentNode;){if(s=s.parentNode,null!=s.offsetParent){var a=!0;window.opera&&(s==o.parentNode||"TR"==s.nodeName)&&(a=!1),a&&(s.scrollTop&&s.scrollTop>0&&(i-=s.scrollTop),s.scrollLeft&&s.scrollLeft>0&&(e-=s.scrollLeft))}s==n&&(e+=t.offsetLeft,s.clientLeft&&"TABLE"!=s.nodeName&&(e+=s.clientLeft),i+=t.offsetTop,s.clientTop&&"TABLE"!=s.nodeName&&(i+=s.clientTop),t=s,null==t.offsetParent&&(t.offsetLeft&&(e+=t.offsetLeft),t.offsetTop&&(i+=t.offsetTop)),n=t.offsetParent)}return{left:e,top:i}},function(){}.call(this);